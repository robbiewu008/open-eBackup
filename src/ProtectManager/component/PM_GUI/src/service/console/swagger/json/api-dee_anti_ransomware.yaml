swagger: '2.0'
info:
  version: v1
  title: 勒索软件防护接口
  contact: {}
  license: {}
host: localhost
basePath: /
tags:
  - name: Config Management
    description: Config Controller
  - name: Model Management
    description: Model Controller
  - name: File Extension Filter Management
    description: File Extension Filter
  - name: White List Management
  - name: Fs_File_Extension_Filter_Management
  - name: NAS_Abnormal_Files
  - name: San Config Management
paths:
  /v1/anti/ransomware/config:
    get:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-product: OceanProtect X8000,OceanProtect X6000,OceanProtect X3000,OceanProtect E6000,OceanProtect DataBackup
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      x-dp-admin-role: 'Y'
      x-auditor-role: 'Y'
      tags:
        - Config Management
      summary: 获取配置
      operationId: getConfigUsingGET
      produces:
        - '*/*'
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Config'
            originalRef: Config
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    put:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-product: OceanProtect X8000,OceanProtect X6000,OceanProtect X3000,OceanProtect E6000,OceanProtect DataBackup
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Config Management
      summary: 设置配置
      operationId: setConfigUsingPUT
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - name: X-Auth-Token
          in: header
          description: Access token
          required: true
          type: string
        - in: body
          name: config
          description: 配置参数
          required: true
          schema:
            $ref: '#/definitions/Config'
            originalRef: Config
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Config'
            originalRef: Config
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
  /v1/anti/ransomware/model:
    post:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-product: OceanCyber,OceanProtect X8000,OceanProtect X6000,OceanProtect E6000,OceanProtect DataBackup,HyperDetect
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Model Management
      summary: 增加模型
      operationId: addModelInfoUsingPOST
      consumes:
        - multipart/form-data
      produces:
        - '*/*'
      parameters:
        - name: X-Auth-Token
          in: header
          description: Access token
          required: true
          type: string
        - name: modelFile
          in: formData
          description: 模型文件
          required: true
          type: file
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ModelInfo'
            originalRef: ModelInfo
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    delete:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-product: OceanCyber,OceanProtect X8000,OceanProtect X6000,OceanProtect E6000,OceanProtect DataBackup,HyperDetect
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Model Management
      summary: 删除模型
      operationId: deleteModelUsingDELETE
      produces:
        - '*/*'
      parameters:
        - name: X-Auth-Token
          in: header
          description: Access token
          required: true
          type: string
        - in: body
          name: deleteModelRequest
          description: 删除模型请求
          required: true
          schema:
            $ref: '#/definitions/DeleteModelRequest'
            originalRef: DeleteModelRequest
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/DeleteModelResponse'
            originalRef: DeleteModelResponse
        '204':
          description: No Content
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
      security:
        - Authorization:
            - global
  /v1/anti/ransomware/model/activate:
    put:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-product: OceanCyber,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000,OceanProtect E6000,OceanProtect DataBackup,HyperDetect
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Model Management
      summary: 激活模型
      operationId: activateModelUsingPUT
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - name: X-Auth-Token
          in: header
          description: Access token
          required: true
          type: string
        - in: body
          name: activateModelRequest
          description: 激活模型请求
          required: true
          schema:
            $ref: '#/definitions/ActivateModelRequest'
            originalRef: ActivateModelRequest
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ActivateModelResponse'
            originalRef: ActivateModelResponse
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
  /v1/anti/ransomware/models:
    get:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-rd-admin-role: 'N'
      x-product: OceanCyber,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000,OceanProtect E6000,OceanProtect DataBackup,HyperDetect
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-public-api: 'Y'
      x-dp-admin-role: 'Y'
      x-auditor-role: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Model Management
      summary: 获取模型列表
      operationId: getModelListUsingGET
      produces:
        - '*/*'
      parameters:
        - in: query
          name: pageNum
          description: 页的编号
          required: true
          type: integer
          format: int64
          minimum: 1
          maximum: 500
        - in: query
          name: pageSize
          description: 每页数量
          required: true
          type: integer
          format: int64
          minimum: 1
          maximum: 100
        - name: status
          in: query
          description: 模型状态
          required: false
          type: boolean
          x-example: 'false'
        - name: isLatest
          in: query
          required: false
          description: 获取最新模型
          type: boolean
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Response«List«ModelInfo»»'
            originalRef: Response«List«ModelInfo»»
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
  /v1/anti/ransomware/vstore-detect-configs:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Config Management
      summary: 查询租户检测配置
      operationId: getVstoreDetectConfigs
      produces:
        - '*/*'
      parameters:
        - name: copyDetectConfigStatus
          in: query
          description: 副本检测开启状态
          required: false
          type: array
          items:
            enum:
              - ENABLED
              - DISABLED
            type: string
          maxItems: 2
        - name: ioDetectConfigStatus
          in: query
          description: 实时检测开启状态
          required: false
          type: array
          items:
            enum:
              - ENABLED
              - DISABLED
            type: string
          maxItems: 2
        - name: fileExtensionFilterConfigStatus
          in: query
          required: false
          description: 文件后缀拦截开启状态
          type: array
          items:
            enum:
              - ENABLED
              - DISABLED
            type: string
          maxItems: 2
        - name: pageNum
          in: query
          description: 页的编号
          required: true
          type: integer
          maximum: 100
          minimum: 1
          format: int64
        - name: pageSize
          in: query
          description: 每页数量
          required: true
          type: integer
          maximum: 500
          minimum: 1
          format: int64
        - name: vstoreName
          in: query
          required: false
          description: 租户名称
          type: string
      responses:
        '200':
          description: OK
          schema:
            originalRef: Response«List«VstoreDetectConfig»»
            $ref: '#/definitions/PageListVstoreDetectConfigResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Config Management
      summary: 修改租户检测配置
      operationId: updateVstoreDetectConfigs
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - in: body
          name: vstoreCopyDetectConfig
          description: vstoreCopyDetectConfig
          required: true
          schema:
            originalRef: VstoreCopyDetectConfig
            $ref: '#/definitions/VstoreDetectConfig'
      responses:
        '200':
          description: OK
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
  /v1/anti/ransomware/vstore-infos:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 查询可关联文件后缀拦截规则的租户列表
      operationId: getVstoreInfoUsingGET
      parameters:
        - name: pageNum
          in: query
          required: true
          type: integer
          format: int64
        - name: pageSize
          in: query
          required: true
          type: integer
          format: int64
        - name: vstoreName
          in: query
          required: false
          type: string
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/VstoreInfoResponse'
  /v1/anti/ransomware/file-extension-filter-rules:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 查询租户关联的文件后缀拦截规则
      operationId: getFileExtensionFilterUsingGET
      produces:
        - '*/*'
      parameters:
        - name: pageNum
          in: query
          required: true
          type: integer
          format: int64
          description: 页的编号
        - name: pageSize
          in: query
          required: true
          type: integer
          format: int64
          description: 每页数量
          minimum: 1
          maximum: 100
        - name: fileExtensionName
          in: query
          required: false
          type: string
          description: 按文件扩展名查询
          minLength: 1
          maxLength: 127
        - name: fileExtensionType
          in: query
          required: false
          type: array
          items:
            type: string
          description: 按文件类型查询
        - name: vstoreName
          in: query
          required: false
          description: 按租户名查询
          type: string
          maxLength: 1024
          minLength: 1
        - name: orderBy
          in: query
          required: false
          description: 排序字段
          type: string
          enum:
            - createTime
            - updateTime
        - name: orderType
          in: query
          required: false
          description: 排序类型
          type: string
          enum:
            - asc
            - desc
        - name: vstoreId
          in: query
          required: false
          description: 按租户ID查询
          type: string
          maxLength: 4
        - name: importStatus
          in: query
          required: false
          description: 按导入状态查询
          type: array
          items:
            type: string
      responses:
        '200':
          description: OK
          schema:
            originalRef: CustomFileExtensionResponse
            $ref: '#/definitions/PageListCustomFileExtensionResponse'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 修改租户的文件后缀拦截规则
      operationId: updateFileExtensionFilterUsingPUT
      consumes:
        - application/json
      parameters:
        - name: modifyUserSuffixRequest
          in: body
          required: true
          description: 修改租户后缀请求
          schema:
            $ref: '#/definitions/ModifyUserSuffixRequest'
      responses:
        '200':
          description: ''
    post:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 关联租户的文件后缀拦截规则
      operationId: importFileExtensionFilterUsingPOST
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - in: body
          name: importUserSuffixRequest
          description: 新增本地后缀请求
          required: true
          schema:
            originalRef: ImportUserSuffixRequest
            $ref: '#/definitions/ImportUserSuffixRequest'
      responses:
        '200':
          description: OK
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    delete:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 删除租户已关联的文件后缀拦截规则
      operationId: deleteFileExtensionFilterUsingGet
      consumes:
        - application/json
      parameters:
        - name: importUserSuffixRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/ImportUserSuffixRequest'
          description: 删除文件后缀的请求，包含租户列表和后缀列表
      responses:
        '200':
          description: ''
  /v1/anti/ransomware/file-extension-filter-rules/action/customization:
    post:
      x-dr-role: 'N'
      x-product: OceanCyber,HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 增加自定义文件后缀拦截规则
      operationId: addCustomizationFileExtensionFilterUsingPost
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - in: body
          name: addCustomFileExtensionRequest
          description: 添加自定义勒索文件扩展名请求
          required: true
          schema:
            originalRef: AddCustomFileExtensionRequest
            $ref: '#/definitions/AddCustomFileExtensionRequest'
      responses:
        '200':
          description: OK
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
    delete:
      x-dr-role: 'N'
      x-product: OceanCyber,HyperDetect
      tags:
        - File Extension Filter Management
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      summary: 删除自定义文件后缀拦截规则
      operationId: deleteCustomizationFileExtensionFilterUsingDelete
      consumes:
        - application/json
      parameters:
        - name: deleteCustomFileExtensionRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/DeleteCustomFileExtensionRequest'
      responses:
        '200':
          description: ''
  /v1/anti/ransomware/io-detect/summary:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      tags:
        - Config Management
      summary: 查询实时检测告警汇总
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      operationId: getIoDetectSummary
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页的编号
          type: integer
          format: int64
          maximum: 100
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: integer
          format: int64
          maximum: 500
      responses:
        '200':
          description: 实时检测告警结果汇总
          schema:
            $ref: '#/definitions/Response«List«IoDetectSummary»»'
  /v1/anti/ransomware/vstore-detect-configs/summary:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Config Management
      summary: 查询租户检测配置汇总
      description: 查询租户检测配置汇总
      operationId: getVstoreDetectConfigsSummary
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/VstoreDetectConfigSummary'
  /v1/anti/ransomware/file-extension-filter-rules/action/scan:
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - File Extension Filter Management
      summary: 扫描DeviceManger文件过滤规则和ProtectManger配置规则是否一致
      operationId: scanFileExtensionFilter
      responses:
        '200':
          description: ''
  /v1/anti/ransomware/white-list:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      tags:
        - White List Management
      summary: 查询勒索检测白名单
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      description: 查询勒索检测白名单
      operationId: getWhiteListInfoUsingGET
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页码
          type: integer
          format: int64
        - name: pageSize
          in: query
          required: true
          description: 页面大小
          type: integer
          format: int64
        - name: content
          in: query
          required: false
          description: 模糊匹配白名单内容
          type: string
        - name: type
          in: query
          required: false
          type: array
          items:
            type: string
            enum:
              - DIR
              - FILE
          description: 筛选白名单类型
        - name: vstoreId
          in: query
          required: false
          description: 租户ID
          type: string
        - name: order
          in: query
          required: false
          description: 按时间正序或倒序
          type: string
          enum:
            - asc
            - desc
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/PagedWhiteListInfoResponse'
    post:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 创建勒索检测白名单
      description: 创建勒索检测白名单
      operationId: createWhiteListUsingPOST
      consumes:
        - application/json
      parameters:
        - name: createWhiteListRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/CreateWhiteListRequest'
      responses:
        '200':
          description: OK
    delete:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 删除勒索检测白名单
      description: 删除勒索检测白名单
      operationId: deleteWhiteListUsingDELETE
      consumes:
        - application/json
      parameters:
        - name: deleteWhiteListRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/DeleteWhiteListRequest'
      responses:
        '200':
          description: OK
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 修改勒索检测白名单
      description: 修改勒索检测白名单
      operationId: modifyWhiteListUsingPUT
      consumes:
        - application/json
      parameters:
        - name: modifyWhiteListRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/ModifyWhiteListRequest'
      responses:
        '200':
          description: OK
  /v1/anti/ransomware/white-list-association:
    post:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 创建勒索检测白名单和租户关联信息
      description: 创建勒索检测白名单和租户关联信息
      operationId: createWhiteListAssociationUsingPOST
      consumes:
        - application/json
      parameters:
        - name: createWhiteListAssociationRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/CreateWhiteListAssociationRequest'
      responses:
        '200':
          description: OK
    delete:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 删除勒索检测白名单和租户关联信息
      description: 删除勒索检测白名单和租户关联信息
      operationId: deleteWhiteListAssociationUsingDELETE
      consumes:
        - application/json
      parameters:
        - name: deleteWhiteListAssociationRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/DeleteWhiteListAssociationRequest'
      responses:
        '200':
          description: OK
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - White List Management
      summary: 修改勒索检测白名单和租户关联信息
      description: 修改勒索检测白名单和租户关联信息
      operationId: modifyWhiteListAssociationUsingPUT
      consumes:
        - application/json
      parameters:
        - name: modifyWhiteListAssociationRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/ModifyWhiteListAssociationRequest'
      responses:
        '200':
          description: OK
  /v1/anti/ransomware/fs-file-extension-filter-rules:
    post:
      tags:
        - Fs_File_Extension_Filter_Management
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      operationId: addFsExtensionFilterUsingPOST
      consumes:
        - application/json
      parameters:
        - name: importFsSuffixRequest
          in: body
          required: false
          schema:
            $ref: '#/definitions/ImportFsExtensionRequest'
      responses:
        '200':
          description: ''
    delete:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 取消文件系统过滤规则关联
      operationId: deleteFsExtensionFilterUsingDELETE
      consumes:
        - application/json
      parameters:
        - name: deleteFsSuffixRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/ImportFsExtensionRequest'
      responses:
        '200':
          description: ''
    put:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 修改文件系统过滤规则
      operationId: modifyFsExtensionFilterUsingPUT
      consumes:
        - application/json
      parameters:
        - name: modifyFsSuffixRequest
          in: body
          required: false
          schema:
            $ref: '#/definitions/ModifyFsSuffixRequest'
      responses:
        '200':
          description: ''
    get:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 查询文件系统过滤规则信息
      operationId: getFsExtensionFilterUsingGET
      consumes:
        - application/json
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页码
          type: string
          minLength: 1
          maxLength: 201
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: string
          minLength: 1
          maxLength: 500
        - name: fileExtensionName
          in: query
          required: false
          description: 按文件扩展名模糊匹配
          type: string
          minLength: 0
          maxLength: 127
        - name: fileExtensionType
          in: query
          required: false
          description: 按过滤规则类型查询信息
          type: string
          minLength: 0
          maxLength: 20
        - name: importStatus
          in: query
          required: false
          description: 按过滤规则类型查询信息
          type: string
          minLength: 0
          maxLength: 20
        - name: vstoreName
          in: query
          required: false
          description: 按租户名模糊匹配
          type: string
          minLength: 0
          maxLength: 256
        - name: fsName
          in: query
          required: false
          description: 按文件系统名称模糊匹配
          type: string
          minLength: 0
          maxLength: 1024
        - name: deviceId
          in: query
          required: false
          description: 按设备ID查询
          type: string
          maxLength: 1024
          minLength: 0
        - name: fsId
          in: query
          required: false
          description: 按文件系统ID查询
          type: string
          maxLength: 1024
          minLength: 0
        - name: orderBy
          in: query
          required: false
          description: 排序名称（updateTime|createTime）
          type: string
          pattern: updateTime|createTime
        - name: orderType
          in: query
          required: false
          description: 升降序（asc|desc）
          type: string
          pattern: asc|desc
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/PageListFsExtensionResponse'
  /v1/anti/ransomware/fs-file-block-config:
    get:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 文件系统文件拦截配置信息
      operationId: getFsFileBlockConfigUsingGET
      consumes:
        - application/json
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页码
          type: integer
          format: int64
          minimum: 1
          maximum: 201
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: integer
          format: int64
          minimum: 1
          maximum: 500
        - name: vstoreName
          in: query
          required: false
          description: 租户名称模糊匹配
          type: string
          minLength: 0
          maxLength: 1024
        - name: fsName
          in: query
          required: false
          description: 文件系统名称模糊匹配
          type: string
          minLength: 0
          maxLength: 1024
        - name: deviceId
          in: query
          required: false
          description: 设备ID精准匹配
          type: string
          minLength: 0
          maxLength: 1024
        - name: configStatus
          in: query
          required: false
          description: 事前检测是否使能（ENABLED, DISABLED）
          type: array
          items:
            type: string
            minLength: 0
            maxLength: 20
          minItems: 0
          maxItems: 2
        - name: fsId
          in: query
          required: false
          description: 文件系统ID模糊匹配
          type: string
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/pageListFsFileBlockConfigResponse'
    put:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 修改文件系统文件拦截配置（开启或禁用）
      operationId: modifyFsFileBlockConfigUsingPUT
      consumes:
        - application/json
      parameters:
        - name: switchFileBlockConfigRequest
          in: body
          required: true
          schema:
            $ref: '#/definitions/SwitchFileBlockConfigRequest'
      responses:
        '200':
          description: ''
  /v1/anti/ransomware/fs-file-block-config/action/scan:
    put:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      description: 扫描文件系统
      operationId: scanFsFileBlockUsingPUT
      consumes:
        - application/json
      responses:
        '200':
          description: ''
  /v1/anti/ransomware/detect/copy/infected-files:
    get:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 8083
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - NAS_Abnormal_Files
      summary: 查询NAS异常文件清单
      description: 查询NAS异常文件清单
      operationId: queryNasInfectedFiles
      parameters:
        - name: copyId
          in: query
          required: true
          description: 副本（快照）ID
          type: string
          maxLength: 1024
        - name: pageNum
          in: query
          required: true
          description: 页的编号，从第一页开始。
          type: integer
          format: int64
          minimum: 1
          maximum: 201
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: integer
          format: int64
          minimum: 1
          maximum: 500
        - name: filePath
          in: query
          required: false
          description: 文件名（模糊匹配）
          type: string
          maxLength: 3000
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/NasInfectedFilesResponse'
  /v1/anti/ransomware/fs-file-extension-filter-rules/filesystems:
    get:
      x-dr-role: 'N'
      x-product: OceanCyber
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'N'
      x-rd-admin-role: 'Y'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'Y'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - Fs_File_Extension_Filter_Management
      operationId: getFileSystemInfoUsingGET
      consumes:
        - application/json
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页码
          type: integer
          format: int64
          minimum: 1
          maximum: 201
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: integer
          format: int64
          minimum: 1
          maximum: 500
        - name: fileExtensionNames
          in: query
          required: true
          description: 文件扩展名过滤规则名称精确匹配
          type: array
          items:
            type: string
            minLength: 1
            maxLength: 127
          minItems: 1
          maxItems: 1024
        - name: fsName
          in: query
          required: false
          description: 文件系统名称模糊匹配
          type: string
          minLength: 0
          maxLength: 1024
        - name: vstoreName
          in: query
          required: false
          description: 租户名称模糊匹配
          type: string
          minLength: 0
          maxLength: 256
        - name: deviceId
          in: query
          required: false
          description: 设备ID
          type: string
          minLength: 0
          maxLength: 1024
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/PageListQueryFsInfoResponse'
  /v1/anti/ransomware/san-detect-switch:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - San Config Management
      summary: 查询san防勒索开关配置信息
      operationId: getSanDetectSwitch
      parameters:
        - name: pageNum
          in: query
          required: true
          description: 页的编号
          type: integer
          format: int64
          minimum: 1
          maximum: 3500
        - name: pageSize
          in: query
          required: true
          description: 每页数量
          type: integer
          format: int64
          minimum: 1
          maximum: 500
        - name: isRealTimeDetectEnabled
          in: query
          required: false
          description: 实时勒索检测开启状态
          type: array
          minItems: 0
          maxItems: 2
          items:
            type: boolean
        - name: isCopyDetectEnabled
          in: query
          required: false
          description: 智能勒索检测开启状态
          type: array
          minItems: 0
          maxItems: 2
          items:
            type: boolean
        - name: lunName
          in: query
          required: false
          description: lun名称
          type: string
        - name: vstoreName
          in: query
          required: false
          description: 租户名称
          type: string
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/SanDetectSwitchResponse'
    put:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - San Config Management
      summary: 修改san防勒索开关配置信息
      operationId: postSanDetectSwitch
      parameters:
        - name: detectSwitchConfig
          in: body
          required: true
          schema:
            $ref: '#/definitions/DetectSwitchConfig'
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/PutSanDetectSwitchResponse'
  /v1/anti/ransomware/san-io-detect/report:
    get:
      x-dr-role: 'N'
      x-product: HyperDetect
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'Y'
      x-rd-admin-role: 'N'
      x-auditor-role: 'Y'
      x-dp-admin-role: 'N'
      x-public-api: 'Y'
      x-sysadmin-role: 'Y'
      tags:
        - San Config Management
      summary: san获取事中检测报告
      operationId: getSanIoReport
      parameters:
        - name: entity
          in: query
          required: true
          description: 告警id
          type: string
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/SanIoReport'
securityDefinitions:
  Authorization:
    type: apiKey
    name: TOKEN
    in: header
definitions:
  ActivateModelRequest:
    properties:
      id:
        type: string
        example: '1'
        description: 模型编号
        minLength: 1
        maxLength: 1024
    title: ActivateModelRequest
    required:
      - id
  ActivateModelResponse:
    type: object
    properties:
      activated:
        type: boolean
        description: 模型激活是否成功
    title: ActivateModelResponse
  Config:
    properties:
      dynamicDetection:
        type: boolean
        description: 是否开启动态探测
    title: Config
    required:
      - dynamicDetection
  DeleteModelRequest:
    properties:
      id:
        type: string
        example: '1'
        description: 模型编号
        minLength: 1
        maxLength: 1024
    title: DeleteModelRequest
    required:
      - id
  DeleteModelResponse:
    type: object
    properties:
      deleted:
        type: boolean
        description: 模型删除是否成功
    title: DeleteModelResponse
  ModelInfo:
    type: object
    properties:
      desc:
        type: string
        description: 模型描述
      id:
        type: string
        description: 模型编号
      name:
        type: string
        description: 模型名称
      signatureInfo:
        type: string
        description: 签名信息
      status:
        type: boolean
        description: 模型状态
      updateTime:
        type: string
        description: 更新时间
      version:
        type: string
        description: 模型版本
    title: ModelInfo
  Response«List«ModelInfo»»:
    type: object
    properties:
      detailParams:
        type: array
        description: 错误参数
        items:
          type: string
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      errorMessage:
        type: string
        description: 错误描述
      records:
        type: array
        description: 数据
        items:
          $ref: '#/definitions/ModelInfo'
          originalRef: ModelInfo
      totalCount:
        type: integer
        format: int64
        description: 翻页
    title: Response«List«ModelInfo»»
  AddCustomFileExtensionRequest:
    properties:
      fileExtensionName:
        type: string
        description: 自定义待过滤文件扩展名
        minLength: 1
        maxLength: 127
    title: AddCustomFileExtensionRequest
    required:
      - fileExtensionName
  PageListCustomFileExtensionResponse:
    properties:
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      errorMessage:
        type: string
        description: 错误描述
      parameters:
        type: array
        items:
          type: string
        description: 错误参数
      records:
        items:
          $ref: '#/definitions/CustomFileExtensionResponse'
        description: 数据
        type: array
      totalCount:
        type: integer
        format: int64
        description: 翻页
    title: CustomFileExtensionResponse
  DeleteCustomFileExtensionRequest:
    properties:
      deleteExtensions:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 127
        description: 待删除的自定义后缀列表
    title: DeleteCustomFileExtensionRequest
  ImportUserSuffixRequest:
    properties:
      vstoreIds:
        type: array
        description: 导入的租户ID合集
        items:
          type: string
          minLength: 1
          maxLength: 4
      extensions:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 127
        description: 待导入的文件后缀合集
    title: ImportUserSuffixRequest
    required:
      - vstoreIds
      - extensions
  PageListVstoreDetectConfigResponse:
    properties:
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      errorMessage:
        type: string
        description: 错误描述
      parameters:
        type: array
        description: 错误参数
        items:
          type: string
      records:
        type: array
        description: 数据
        items:
          originalRef: VstoreDetectConfig
          $ref: '#/definitions/VstoreDetectConfigResponse'
      totalCount:
        type: integer
        format: int64
        description: 翻页
    title: Response«List«VstoreDetectConfig»»
  VstoreDetectConfigResponse:
    properties:
      copyDetectConfigStatus:
        type: string
        description: 副本检测开启状态
        enum:
          - DISABLED
          - ENABLED
      ioDetectConfigStatus:
        type: string
        description: 实时检测开启状态
        enum:
          - DISABLED
          - ENABLED
      ioEnhancedDetectConfigStatus:
        type: string
        description: 实时检测误告警分析开启状态
        enum:
          - DISABLED
          - ENABLED
      vstoreId:
        type: string
        description: 租户ID
      vstoreName:
        type: string
        description: 租户名称
      fileExtensionFilterConfigStatus:
        type: string
        description: 文件后缀拦截开启状态
        enum:
          - DISABLED
          - ENABLED
      enabledFileExtensionFilterRuleCount:
        type: integer
        format: int64
        description: 拦截的文件后缀数量
    title: VstoreDetectConfig
    type: object
  ModifyUserSuffixRequest:
    properties:
      vstoreId:
        type: string
        description: 修改租户的ID
        minLength: 1
        maxLength: 4
      extensions:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 127
        description: 修改后该租户的后缀合集
    required:
      - vstoreId
      - extensions
  CustomFileExtensionResponse:
    properties:
      vstoreInfos:
        type: array
        items:
          $ref: '#/definitions/VstoreInfo'
        description: 关联租户Id
      fileExtensionName:
        type: string
        description: 文件扩展名
      fileExtensionType:
        type: string
        description: 文件类型
      importStatus:
        type: string
        description: 文件操作状态
      createTime:
        type: string
        description: 创建时间
      updateTime:
        type: string
        description: '更新时间: 表现为导入时间'
  VstoreInfo:
    properties:
      vstoreId:
        type: string
      vstoreName:
        type: string
  VstoreInfoResponse:
    properties:
      errorCode:
        type: integer
        format: int64
      records:
        type: array
        items:
          $ref: '#/definitions/VstoreInfo'
      totalCount:
        type: integer
        format: int64
      parameters:
        type: array
        items:
          type: string
      errorMessage:
        type: string
    required:
      - records
  VstoreDetectConfig:
    description: 租户检测配置请求
    properties:
      vstoreIds:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 4
        description: 租户ID列表
        minItems: 1
        maxItems: 1024
      configField:
        type: string
        description: 待配置字段
        enum:
          - COPY_DETECT
          - IO_DETECT
          - FILE_EXTENSION_FILTER
      isEnabled:
        type: boolean
        description: 是否启用
    required:
      - vstoreIds
      - configField
      - isEnabled
  IoDetectSummary:
    description: 实时检测汇总
    properties:
      vstoreName:
        type: string
        description: 租户名称
      alarmCount:
        type: integer
        format: int32
        description: 告警数量
      alarmIds:
        type: array
        items:
          type: string
        description: 告警ID列表
      sanAlarmCount:
        type: integer
        format: int32
        description: san告警数量
      sanAlarmEntityIds:
        type: array
        items:
          type: string
        description: san告警ID列表
    type: object
  DetectConfigCount:
    description: 检测配置计数
    properties:
      enabledCount:
        type: integer
        format: int64
        description: 已开启检测的租户数量
      disabledCount:
        type: integer
        format: int64
        description: 未开启检测的租户数量
  VstoreDetectConfigSummary:
    properties:
      fileExtensionFilterConfigSummary:
        description: 文件拦截配置汇总
        $ref: '#/definitions/DetectConfigCount'
      ioDetectConfigSummary:
        description: 实时检测配置汇总
        $ref: '#/definitions/DetectConfigCount'
      copyDetectConfigSummary:
        description: 副本检测配置汇总
        $ref: '#/definitions/DetectConfigCount'
      sanIoDetectConfigSummary:
        description: San实时勒索检测配置汇总
        $ref: '#/definitions/SanDetectConfigCount'
      sanCopyDetectConfigSummary:
        description: San智能勒索检测配置汇总
        $ref: '#/definitions/SanDetectConfigCount'
    type: object
  Response«List«IoDetectSummary»»:
    properties:
      detailParams:
        type: array
        description: 错误参数
        items:
          type: string
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      errorMessage:
        type: string
        description: 错误描述
      records:
        type: array
        description: 数据
        items:
          $ref: '#/definitions/IoDetectSummary'
          originalRef: ModelInfo
      totalCount:
        type: integer
        format: int64
        description: 翻页
    title: Response«List«ModelInfo»»
  WhiteListInfoResponse:
    properties:
      vstoreInfos:
        type: array
        items:
          $ref: '#/definitions/VstoreInfo'
        description: 关联的租户信息
      content:
        type: string
        description: 白名单内容
      type:
        type: string
        description: 白名单类型
        enum:
          - DIR
          - FILE
      id:
        type: string
        description: 白名单ID
      createTime:
        type: string
        description: 创建时间
    required:
      - vstoreInfos
      - content
      - type
      - id
      - createTime
  PagedWhiteListInfoResponse:
    properties:
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      errorMessage:
        type: string
        description: 错误描述
      parameters:
        type: array
        items:
          type: string
        description: 错误参数
      records:
        type: array
        items:
          $ref: '#/definitions/WhiteListInfoResponse'
        description: 数据
      totalCount:
        type: integer
        format: int64
        description: 总数
  CreateWhiteListRequest:
    properties:
      content:
        type: string
        description: 白名单内容
      type:
        type: string
        description: 白名单类型
        enum:
          - DIR
          - FILE
      vstoreIds:
        type: array
        items:
          type: string
        description: 租户ID列表
    required:
      - content
      - type
  DeleteWhiteListRequest:
    required:
      - ids
    properties:
      ids:
        type: array
        items:
          type: string
        description: 白名单ID列表
  ModifyWhiteListRequest:
    required:
      - content
      - id
    properties:
      content:
        type: string
        description: 修改后的白名单内容
      id:
        type: string
        description: 白名单ID
  CreateWhiteListAssociationRequest:
    required:
      - ids
      - vstoreIds
    properties:
      ids:
        type: array
        items:
          type: string
        description: 白名单ID列表
      vstoreIds:
        type: array
        items:
          type: string
        description: 租户ID列表
  DeleteWhiteListAssociationRequest:
    required:
      - ids
      - vstoreIds
    properties:
      ids:
        type: array
        items:
          type: string
        description: 白名单ID列表
      vstoreIds:
        type: array
        items:
          type: string
        description: 租户ID列表
  ModifyWhiteListAssociationRequest:
    required:
      - vstoreId
      - ids
    properties:
      vstoreId:
        type: string
        description: 租户ID
      ids:
        type: array
        items:
          type: string
        description: 修改后的白名单ID集合
  FileSystemInfo:
    type: object
    description: 文件系统信息
    required:
      - deviceId
      - fsId
    properties:
      deviceId:
        type: string
        description: 设备ID
        minLength: 1
        maxLength: 128
      deviceName:
        type: string
        description: 设备名
        minLength: 1
        maxLength: 128
      fsId:
        type: string
        description: 文件系统ID
        minLength: 1
        maxLength: 128
      fsName:
        type: string
        description: 文件系统名
        minLength: 1
        maxLength: 1024
  ImportFsExtensionRequest:
    type: object
    description: 导入文件系统过滤规则请求
    required:
      - fileSystemInfos
      - extensions
    properties:
      fileSystemInfos:
        type: array
        items:
          $ref: '#/definitions/FileSystemInfo'
        description: 文件系统信息
      extensions:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 127
        description: 过滤规则
        minItems: 1
        maxItems: 1024
  ModifyFsSuffixRequest:
    type: object
    description: 修改文件系统过滤规则请求
    required:
      - fileSystemInfo
      - extensions
    properties:
      fileSystemInfo:
        description: 文件系统信息
        $ref: '#/definitions/FileSystemInfo'
      extensions:
        type: array
        items:
          type: string
          minLength: 1
          maxLength: 127
        description: 过滤规则
        minItems: 0
        maxItems: 1024
  QueryFsFileExtensionInfoResponse:
    type: object
    description: 查询文件系统过滤规则响应
    properties:
      fsNumber:
        type: integer
        format: int32
        description: 文件系统数量
      fileExtensionName:
        type: string
        description: 文件扩展名
      fileExtensionType:
        type: string
        description: 过滤规则类型
      importStatus:
        type: string
        description: 过滤规则状态
      createTime:
        type: string
        description: 创建时间
      updateTime:
        type: string
        description: 更新时间
  PageListFsExtensionResponse:
    type: object
    description: 查询文件系统文件扩展名过滤规则汇总回显
    properties:
      errorcode:
        type: integer
        format: int64
        description: 错误码
      errorMessage:
        type: string
        description: 错误描述
      parameters:
        type: array
        items:
          type: string
        description: 错误参数
      records:
        type: array
        items:
          $ref: '#/definitions/QueryFsFileExtensionInfoResponse'
        description: 数据
      totalCount:
        type: integer
        format: int64
        description: 总数
  FsFileBlockConfigResponse:
    type: object
    properties:
      fileSystemInfo:
        description: 文件系统信息
        $ref: '#/definitions/FileSystemInfo'
      vstoreName:
        type: string
        description: 租户名称
        minLength: 0
        maxLength: 1024
      fileExtensionNumber:
        type: string
        description: 过滤规则数量
      isEnable:
        type: string
        description: 是否开启（ENABLED, DISABLED）
        minLength: 0
        maxLength: 20
  pageListFsFileBlockConfigResponse:
    type: object
    description: 文件系统文件拦截配置汇总回显
    properties:
      errorCode:
        type: integer
        format: int64
        description: 错误码
      errorMessage:
        type: string
        description: 错误描述
      parameters:
        type: array
        items:
          type: string
        description: 错误参数
      records:
        type: array
        items:
          $ref: '#/definitions/FsFileBlockConfigResponse'
        description: 数据
      totalCount:
        type: integer
        format: int64
        description: 总数
  SwitchFileBlockConfigRequest:
    type: object
    required:
      - fileSystemInfos
      - configStatus
    properties:
      fileSystemInfos:
        type: array
        items:
          $ref: '#/definitions/FileSystemInfo'
        description: 文件系统信息
        minItems: 0
        maxItems: 100
      configStatus:
        type: string
        description: 文件拦截状态（ENABLED, DISABLED）
        minLength: 0
        maxLength: 20
  NasInfectedFilesResponse:
    type: object
    properties:
      total:
        type: integer
        format: int64
        description: 总记录
      records:
        type: array
        items:
          $ref: '#/definitions/InfectedFile'
        description: 文件路径列表
        minItems: 0
        maxItems: 500
  InfectedFile:
    type: object
    description: 可疑文件模型
    properties:
      path:
        type: string
        description: 路径
        minLength: 0
        maxLength: 3000
  QueryFsInfoResponse:
    type: object
    properties:
      fileSystemInfos:
        type: array
        items:
          $ref: '#/definitions/FileSystemInfo'
        description: 文件系统信息
  PageListQueryFsInfoResponse:
    type: object
    properties:
      errorCode:
        type: integer
        format: int64
        description: 错误码
      errorMessage:
        type: string
        description: 错误信息
      parameters:
        type: array
        items:
          type: string
        description: 错误参数
      records:
        description: 文件系统信息
        $ref: '#/definitions/QueryFsInfoResponse'
      totalCount:
        type: integer
        format: int64
        description: 总数
  BaseSanDetectSwitchResponse:
    type: object
    required:
      - id
      - lunId
      - lunName
      - vstoreId
      - vstoreName
      - isRealTimeDetectEnabled
      - isRealTimeEnhancedDetectEnabled
      - isCopyDetectEnabled
    properties:
      id:
        type: string
        description: id
      lunId:
        type: string
        description: lunId
      lunName:
        type: string
        description: lun名称
      vstoreId:
        type: string
        description: 租户id
      vstoreName:
        type: string
        description: 租户名称
      isRealTimeDetectEnabled:
        type: boolean
        description: 是否开启实时勒索检测
      isRealTimeEnhancedDetectEnabled:
        type: boolean
        description: 是否开启勒索检测误告警分析
      isCopyDetectEnabled:
        type: boolean
        description: 是否开启智能勒索检测
      isMount:
        type: boolean
      createTime:
        type: integer
        format: int64
      updateTime:
        type: integer
        format: int64
  SanDetectSwitchResponse:
    type: object
    required:
      - records
      - totalCount
    properties:
      records:
        type: array
        items:
          $ref: '#/definitions/BaseSanDetectSwitchResponse'
        description: 数据集
      totalCount:
        type: integer
        format: int32
        description: 总数
      errorCode:
        type: integer
        format: int64
      detailParams:
        type: array
        items:
          type: string
      errorMessage:
        type: string
  DetectSwitchConfig:
    type: object
    required:
      - lunDetectConfigField
      - ids
    properties:
      lunDetectConfigField:
        type: string
        enum:
          - COPY_DETECT
          - IO_DETECT
        description: 实时勒索、智能勒索检测判断
      isRealTimeDetectEnabled:
        type: boolean
        description: 开启/关闭实时勒索检测
      isRealTimeEnhancedDetectEnabled:
        type: boolean
        description: 开启/关闭勒索检测误告警分析
      isCopyDetectEnabled:
        type: boolean
        description: 开启/关闭智能勒索检测
      ids:
        type: array
        items:
          type: string
        description: id集合
      lunIds:
        type: array
        items:
          type: string
        description: lun id集合
  PutSanDetectSwitchResponse:
    type: object
    required:
      - records
    properties:
      records:
        type: boolean
        description: 是否修改成功
      errorCode:
        type: integer
        format: int64
        description: 错误编码
      detailParams:
        type: array
        items:
          type: string
        description: 错误参数
      errorMessage:
        type: string
        description: 错误信息
  SanDetectConfigCount:
    type: object
    required:
      - enabledCount
      - disabledCount
    properties:
      enabledCount:
        type: integer
        format: int64
        description: 开启检测的lun的数量
      disabledCount:
        type: integer
        format: int64
        description: 未开启检测的lun的数量
  SanIoReport:
    type: object
    properties:
      records:
        properties:
          report:
            type: string
            example: '{"en-us":"Real-time monitoring and analysis of LUN access show that real-time I/Os have the following characteristics:\r\n(1)Read I/O ratio:49.595%\r\n(2)Write I/O Ratio:50.405%\r\n(3)Write Logical Block Address Ratio:45.585%\r\nBy detecting and analyzing data in a large number of write logic blocks,\r\nthe suspected infection characteristics are as follows:\r\nAdd write data:320MB\r\nWriting a large amount of high-entropy data：320MB\r\nPercentage of instantaneously written high-entropy data：100%\r\nFor details about the implementation principles of detection algorithms, see《HyperDetect Feature Guide for SAN》。","zh-cn":"通过对LUN访问情况实时监控分析，其实时IO读写特征如下：\r\n(1)读IO比例：49.595%\r\n(2)写IO比例：50.405%\r\n(3)写逻辑块地址比例：45.585%\r\n通过对大量写逻辑块中数据检测分析，疑似感染特征如下：\r\n新增写入数据：320MB\r\n写入大量高熵数据：320MB\r\n瞬时写入高熵数据比例：100%\r\n如需要了解更多检测算法实现原理，请参考《HyperDetect特性指南(块业务)》。"}'
      totalCount:
        type: integer
        format: int32
        example: 0
      errorCode:
        type: integer
        format: int32
        example: 0
      errorMessage:
        type: string
        example: OK
