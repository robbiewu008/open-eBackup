<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
  This file is a part of the open-eBackup project.
  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  If a copy of the MPL was not distributed with this file, You can obtain one at
  http://mozilla.org/MPL/2.0/.
  
  Copyright (c) [2024] Huawei Technologies Co.,Ltd.
  
  THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
  EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
  MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  -->

<html lang="en-us" xml:lang="en-us">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="DC.Type" content="topic">
  <meta name="DC.Title" content="Step 9: Performing Backup">
  <meta name="product" content="">
  <meta name="DC.Relation" scheme="URI" content="nas_s_0020.html">
  <meta name="prodname" content="">
  <meta name="version" content="">
  <meta name="brand" content="30-OceanProtect Appliance 1.5.0-1.6.0 Help Center">
  <meta name="DC.Publisher" content="20241029">
  <meta name="prodname" content="csbs">
  <meta name="documenttype" content="usermanual">
  <meta name="DC.Format" content="XHTML">
  <meta name="DC.Identifier" content="nas_s_0029">
  <meta name="DC.Language" content="en-us">
  <link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
  <title>Step 9: Performing Backup</title>
 </head>
 <body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px">
  <a name="nas_s_0029"></a><a name="nas_s_0029"></a>
  <h1 class="topictitle1">Step 9: Performing Backup</h1>
  <div>
   <p>Before performing backup, you need to associate the resources to be protected with a specified SLA policy. The system protects the resources based on the SLA policy and periodically performs backup jobs based on the SLA policy. You can perform a backup job immediately through manual backup.</p>
   <div class="section">
    <h4 class="sectiontitle">Precautions</h4>
    <ul>
     <li>For a NAS share discovered through device registration, if the NAS share has authentication information, complete the configuration by referring to <a href="nas_s_0023.html">Step 3: Configuring NAS Share Information (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>. Otherwise, the backup fails.</li>
     <li>For an NFS share, ensure that the current device has the read and write permissions on the NFS share directory and the <strong>no_root_squash</strong> option is enabled. For details about how to configure NFS share access permissions, see <a href="nas_s_0025.html">Step 4: Configuring Access Permissions (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>.</li>
     <li>For a CIFS share, ensure that the current device has the read and write permissions on the CIFS share directory. You are advised to use a user in the Administrator group for backup. Otherwise, only files and directories whose read and write permissions are granted to the device can be backed up. For details about how to configure CIFS share access permissions, see <a href="nas_s_0025.html">Step 4: Configuring Access Permissions (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>.</li>
    </ul>
    <ul>
     <li id="nas_s_0029__nas_s_0017_li147271733132211">During the execution of a manual backup job, the parameters (except <span class="uicontrol" id="nas_s_0029__nas_s_0017_uicontrol970711415461"><b><span id="nas_s_0029__nas_s_0017_text1370618444612"><strong>Automatic Retry</strong></span></b></span>) defined in the SLA, such as <span class="uicontrol" id="nas_s_0029__nas_s_0017_uicontrol10707164144616"><b><span id="nas_s_0029__nas_s_0017_text1770784134614"><strong>Rate Limiting Policies</strong></span></b></span>, will take effect.</li>
     <li id="nas_s_0029__nas_s_0017_li31561026997">Copies generated by manual backup are retained for the duration defined in the SLA.</li>
    </ul>
    <ul>
     <li>If a replication or archive policy has been defined in the SLA, the system will perform replication or archiving once based on the SLA when you perform manual backup.</li>
    </ul>
   </div>
   <div class="section">
    <h4 class="sectiontitle">Procedure</h4>
    <ol>
     <li><span>Choose <span class="uicontrol" id="nas_s_0029__en-us_topic_0000001839142377_uicontrol79081114124111"><b><span id="nas_s_0029__en-us_topic_0000001839142377_text99081414144119"><strong>Protection</strong></span> &gt; File Systems &gt; NAS Shares</b></span>.</span><p></p>
      <div class="note" id="nas_s_0029__en-us_topic_0000001839142377_note397892312184">
       <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
       <div class="notebody">
        <p id="nas_s_0029__en-us_topic_0000001839142377_p5978112341818">For 1.5.0, choose <span class="uicontrol" id="nas_s_0029__en-us_topic_0000001839142377_uicontrol129783237180"><b><span id="nas_s_0029__en-us_topic_0000001839142377_text10978172391818"><strong>Protection</strong></span> &gt; File Services &gt; NAS Shares</b></span>.</p>
       </div>
      </div> <p></p></li>
     <li><span>In the row where a NAS share to be protected resides, choose <span class="uicontrol"><b><span><strong>More</strong></span> &gt; <span><strong>Protect</strong></span></b></span>.</span></li>
     <li><span>Select the created SLA.</span><p></p><p>You can also click <span class="uicontrol"><b><span><strong>Create</strong></span></b></span> to create an SLA.</p>
      <div class="note">
       <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
       <div class="notebody">
        <p id="nas_s_0029__en-us_topic_0000001964713008_p125947145711"><span id="nas_s_0029__en-us_topic_0000001964713008_ph1413818422327">If a WORM policy has been configured for the resource to be protected, select an SLA without a WORM policy to create protection to avoid WORM policy conflicts.</span></p>
       </div>
      </div> <p></p></li>
     <li><span>Set advanced parameters.</span><p></p>
      <ul>
       <li><span><strong>Channels</strong></span><p>The more the channels, the better the backup performance. However, more memory of the production host will be occupied. Each channel occupies about 200 MB memory.</p> <p>For 1.5.0, when ProtectAgent is deployed on the <span>product</span>, you are advised to reduce the number of channels due to limited container resources.</p></li>
       <li><span><strong>Small File Aggregation</strong></span><p>After this function is enabled, the system aggregates multiple small files in the same directory into a large file to improve backup efficiency. In the scenario where incremental backup is included in the SLA: if forever incremental (synthetic full) backup is not configured in the SLA, small file aggregation cannot be disabled; if forever incremental (synthetic full) backup is configured in the SLA, small file aggregation cannot be enabled.</p> <p>You need to set the following two parameters:</p>
        <ul>
         <li><span><strong>File Size After Aggregation</strong></span>: size of the aggregated file. The value can be 128 KB, 256 KB, 1024 KB, or 4096 KB.</li>
         <li><span><strong>Maximum Aggregated File Size</strong></span>: maximum size of the file to be aggregated. The value can be 128 KB, 256 KB, 1024 KB, or 4096 KB.</li>
        </ul> <p><span><strong>For small file aggregation, the file size after aggregation must be larger than or equal to the size of the largest file aggregated.</strong></span></p></li>
       <li><span><strong>SMB Hard Link Protection</strong></span><p>This option is enabled by default. If too many files exist in the same directory of the NAS share dataset to be protected, the backup job may fail. It is recommended that this option be disabled in this scenario.</p></li>
       <li><span><strong>SMB ACL Protection</strong></span><p>This option is enabled by default. If too many files exist in the same directory of the NAS share dataset to be protected, the backup job may fail. It is recommended that this option be disabled in this scenario.</p></li>
       <li><strong>Hot Data Backup</strong><p>After this function is enabled, the system backs up only the files whose modification time is within the specified time range before backup execution. For example, if the function is enabled and set to 60 days, the system backs up the files whose modification time is within 60 days before backup execution.</p></li>
       <li>Set the automatic indexing function for backup copies.<p>This function is disabled by default. If a VM or VM group is selected for protection and the disks to be backed up contain system disks, the system automatically creates an index for the backup copy after this function is enabled. When using the copy for restoration, you can select one or more files in the copy for restoration and search for files, directories, or links in the copy.</p>
        <div class="note">
         <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
         <div class="notebody">
          <ul>
           <li>Only 1.6.0 and later versions support this parameter.</li>
          </ul>
         </div>
        </div></li>
      </ul> <p></p></li>
     <li><span>Click <span class="uicontrol" id="nas_s_0029__en-us_topic_0000001792503842_uicontrol196538515235"><b>OK</b></span>. </span><p></p><p id="nas_s_0029__en-us_topic_0000001792503842_p25041111535">If the current system time is later than the first backup start time of the SLA, you can select to perform backup immediately after the backup SLA is associated or wait for the next scheduling based on the backup policy set in the SLA.</p> <p></p></li>
     <li><strong>Optional: </strong><span>Perform manual backup.</span><p></p>
      <div class="p">
       If you want to execute a backup job immediately, perform manual backup through the following operations. Otherwise, skip this step.
       <ol type="a">
        <li>In the row of the target resource, choose <strong id="nas_s_0029__en-us_topic_0000001964713008_b146814226353">More</strong> &gt; <span id="nas_s_0029__en-us_topic_0000001964713008_text18439122416533"><strong>Manual Backup</strong></span>.
         <div class="note" id="nas_s_0029__en-us_topic_0000001964713008_note1527151103">
          <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
          <div class="notebody">
           <p id="nas_s_0029__en-us_topic_0000001964713008_en-us_topic_0000001607531736_p870125314544">You can select multiple resources to perform manual backup in batches. Select multiple protected resources and choose <strong id="nas_s_0029__en-us_topic_0000001964713008_b1657653183519">More</strong> &gt; <span id="nas_s_0029__en-us_topic_0000001964713008_text122852865419"><strong>Manual Backup</strong></span> in the upper left corner of the resource list.</p>
          </div>
         </div></li>
        <li>Set the name of the copy generated during manual backup.<p id="nas_s_0029__en-us_topic_0000001964713008_p444210492470">If this parameter is left unspecified, the system sets the copy name to <strong id="nas_s_0029__en-us_topic_0000001964713008_b17709174711816">backup_</strong><em id="nas_s_0029__en-us_topic_0000001964713008_i1371044717814">Timestamp</em> by default.</p></li>
        <li>Select a protection policy.
         <ul>
          <li>If <span><strong>Small File Aggregation</strong></span> is not configured for NAS share protection, the protection policy can be set to <span><strong>Full backup</strong></span> or <span><strong>Forever Incremental (Synthetic Full) Backup</strong></span>.</li>
          <li>If <span><strong>Small File Aggregation</strong></span> is configured for NAS share protection, the protection policy can be set to <span><strong>Full backup</strong></span> or <span><strong>Incremental backup</strong></span>.</li>
         </ul>
         <div class="note">
          <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
          <div class="notebody">
           <p id="nas_s_0029__en-us_topic_0000001964713008_p13522118194919"><span id="nas_s_0029__en-us_topic_0000001964713008_ph19374310343">For 1.6.0 and later versions: If the selected protection policy is different from that configured in the associated SLA, the WORM configuration does not take effect.</span></p>
          </div>
         </div></li>
        <li>Click <span class="uicontrol" id="nas_s_0029__en-us_topic_0000001964713008_uicontrol1662615410817"><b><span id="nas_s_0029__en-us_topic_0000001964713008_text13625854687"><strong>OK</strong></span></b></span>.</li>
       </ol>
      </div> <p></p></li>
    </ol>
    <p></p>
   </div>
  </div>
  <div>
   <div class="familylinks">
    <div class="parentlink">
     <strong>Parent topic:</strong> <a href="nas_s_0020.html">Backing Up a NAS Share</a>
    </div>
   </div>
  </div>
 </body>
</html>