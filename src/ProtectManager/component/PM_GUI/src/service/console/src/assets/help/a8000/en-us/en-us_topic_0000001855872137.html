
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Mounting Object Storage to the Data Protection Agent">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="en-us_topic_0000001839187697.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="30-OceanProtect Appliance 1.5.0-1.6.0 Help Center">
<meta name="DC.Publisher" content="20240608">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TOPIC_0000001855872137">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>Mounting Object Storage to the Data Protection Agent</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="EN-US_TOPIC_0000001855872137"></a><a name="EN-US_TOPIC_0000001855872137"></a>

<h1 class="topictitle1">Mounting Object Storage to the Data Protection Agent</h1>
<div><p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p8060118">Before object storage backup, mount the object storage to the data protection agent host by referring to this section. The mounted object storage can be used as a common file system. You can perform backup and recovery on the management page.</p>
<div class="section" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_section25967533276"><h4 class="sectiontitle">Prerequisites</h4><ul id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_ul23806131347"><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li19380813113413">ProtectAgent has been installed. For details, see <a href="en-us_topic_0000001792549988.html">en-us_topic_0000001792549988.html</a><span class="uicontrol" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_uicontrol232725504"><b>Installing ProtectAgent and Related Software</b></span> in the <i><cite id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_cite930416551262">OceanProtect <span id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_en-us_topic_0000001792502994_ph19170214112011">Appliance 1.5.0-1.6.0</span> ProtectAgent Installation Guide</cite></i>.</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_en-us_topic_0000001408387233_en-us_topic_0000001387868089_en-us_topic_0000001132896521_en-us_topic_0000001125223205_en-us_topic_0000001091431193_li1131331410417">You have obtained the AK and SK of the object storage.</li></ul>
</div>
<div class="section" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_section158567136300"><h4 class="sectiontitle">Precautions</h4><p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p842151933018">Currently, only the S3-compatible object storage is supported. For details about the operating system versions supported by the S3 protocol, visit <a href="https://info.support.huawei.com/storage/comp/#/oceanprotect" target="_blank" rel="noopener noreferrer">Compatibility Query</a>.</p>
</div>
<div class="section" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_section6811356112810"><h4 class="sectiontitle">Procedure</h4><ol id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_ol514291182913"><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li576244513111"><span>Log in to the agent host as user <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b572424673117">root</strong>.</span></li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li414291102913"><span>Download S3fs and install it on the data protection agent host.</span><p><ol type="a" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_ol976883613015"><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li941002710314">Run the following commands in sequence to download the S3fs-fuse source code.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen357510385720">cd /root</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen1862814180326">git clone https://github.com/s3fs-fuse/s3fs-fuse.git</pre>
<p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p563294719339">If the following information is displayed, the source code is successfully downloaded.</p>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen47366753419">Resolving deletas:100% (2203/2203)... done
Checking connectivity... done</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li136432025172117">Run the following command to decompress the package.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen171823392215">unzip s3fs-fuse-master.zip</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li13743175682117">Run the following commands in sequence to install S3fs.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen126411437152215">cd /root/s3fs-fuse/</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen18626651122219">./autogen.sh</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen96941659162214">./configure</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen946112316237">make</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen04303018231">makeinstall</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li243921142918">Run the following command to check whether the installation is successful.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen1235141515293">s3fs</pre>
<p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p868462413291">If the following information is displayed, the installation is successful.</p>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen22841355173015">s3fs: missing BUCKET argument.
Usage: s3fs BUCKET:[PATH] MOUNTPOINT [OPTION]...</pre>
</li></ol>
</p></li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li680971518313"><span>Mount the S3 bucket.</span><p><ol type="a" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_ol1540217317344"><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li940312373418"><a name="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li940312373418"></a><a name="en-us_topic_0000001801653198_li940312373418"></a>Go to the <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b4272124135413">/home</strong> directory and run the following commands in sequence to create the <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b1750394013543">passwd-s3fs</strong> file for storing the AK and SK. The file format must be <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b184711152105417">AK:SK</strong>.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen6761122824115">mkdir s3</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen1654514577417">cd /home/s3</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen04961947133417">touch passwd-s3fs</pre>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen6253197173610">vi passwd-s3fs</pre>
<p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p13620114615348">Example of <span class="uicontrol" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_uicontrol92745519348"><b>passwd-s3fs</b></span> file content:</p>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen17119216358">D3F00C9CE4FC2FC5FFD1:vssChPXeU8hiZ7OTo2vvcSpbigEAAAF85Pwvxa7b</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li817112717365">Run the following command to change the <span class="uicontrol" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_uicontrol18313853203718"><b>passwd-s3fs</b></span> file permission.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen511381503616">chmod 600 passwd-s3fs</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li152853429388">Run the following command to mount the S3 bucket locally. In the command, specify the name of the S3 bucket to be mounted and the mount path. The AK and SK key file path is the absolute path of the <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b159893129011">passwd-s3fs</strong> file created in <a href="#EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li940312373418">1</a>.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen1457613128391">s3fs <em id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_i941814174112">S3 bucket name</em> <em id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_i1834315221410">Local mount path</em> -o passwd_file=<em id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_i8719183314110">AKSK key file path</em> -o url=<em id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_i530594312112">S3 endpoint</em> -o uid=1002,gid=1002 -o use_path_request_style</pre>
<p id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_p1590519268480">Example:</p>
<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen1542183512482">s3fs test-2t /home/s3mount -o passwd_file=/home/s3/passwd-s3fs -o url=http://192.168.99.182 -o uid=1002,gid=1002 -o use_path_request_style</pre>
</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li159661940155017">Run the <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b47686612575">mount</strong> command. If the following information is displayed, the mounting is successful.<pre class="screen" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_screen15916135415502">s3fs on /home/s3mount type fuse.s3fs (rw,nosuid,nodev,relatime,use_id=0,group_id=0)</pre>
<div class="note" id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_note93183121469"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_ul12862137185212"><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li208486813528">If the data protection agent is restarted, the mounted object storage will be unmounted. Before performing subsequent operations, check the mounting status of the object storage.</li><li id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_li1686212714526">After mounting is complete and backup and restoration for the object storage are performed, you can run the <strong id="EN-US_TOPIC_0000001855872137__en-us_topic_0000001801653198_b241394413">umount</strong> command to cancel mounting.</li></ul>
</div></div>
</li></ol>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="en-us_topic_0000001839187697.html">Backup</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div></body>
</html>