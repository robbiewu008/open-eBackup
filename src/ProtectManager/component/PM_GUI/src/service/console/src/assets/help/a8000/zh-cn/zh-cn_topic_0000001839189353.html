
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="安装ProtectAgent软件（手动方式，适用于Windows OS）">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ZH-CN_TOPIC_0000001839189353">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>安装ProtectAgent软件（手动方式，适用于Windows OS）</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="ZH-CN_TOPIC_0000001839189353"></a><a name="ZH-CN_TOPIC_0000001839189353"></a>

<h1 class="topictitle1">安装ProtectAgent软件（手动方式，适用于Windows OS）</h1>
<div><p>您需要在代理主机上安装ProtectAgent软件，ProtectAgent充当<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189365_text1368810101119">OceanProtect</span>与受保护资源之间的代理进行数据备份和恢复。本节介绍登录代理主机后台手动为其安装ProtectAgent。</p>
<div class="section"><h4 class="sectiontitle">前提条件</h4><p>ProtectAgent、OceanProtect以及代理主机操作系统的安装语言请保持一致，否则ProtectAgent或OceanProtect上可能会出现多种语言或乱码。当出现该类情况时，请重新安装相同语言的ProtectAgent、OceanProtect或更换操作系统语言。</p>
</div>
<div class="section"><h4 class="sectiontitle">操作步骤</h4><ol><li><span>下载ProtectAgent软件包。</span><p><ol type="a"><li>选择<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_uicontrol08941439165212">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_text22651956143811">保护</span> &gt; 客户端”</span>。</li><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_li16856140134313"><a name="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_li16856140134313"></a><a name="zh-cn_topic_0000001143474500_li16856140134313"></a>单击<span class="uicontrol">“<span><span>ProtectAgent软件包管理</span></span>”</span>，配置相关参数。<p>参数说明如<a href="#ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_table9849105916553">表1</a>所示。</p>

<div class="tablenoborder"><a name="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_table9849105916553"></a><a name="zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_table9849105916553"></a><table cellpadding="4" cellspacing="0" summary="" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_table9849105916553" frame="border" border="1" rules="all"><caption><b>表1 </b>数据保护代理参数说明</caption><colgroup><col style="width:33.57%"><col style="width:66.43%"></colgroup><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="33.57%" id="mcps1.3.3.2.1.2.1.2.3.2.3.1.1"><p>参数</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="66.43%" id="mcps1.3.3.2.1.2.1.2.3.2.3.1.2"><p>说明</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>模式</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>选择<span class="uicontrol">“<span>下载</span>”</span>。</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>代理类型</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>选择<span class="uicontrol">“<span>通用备份代理</span>”</span>。</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>操作系统</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>选择<span class="uicontrol">“<span>Windows</span>”</span>。</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>应用类型</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>请选择代理主机支持保护的应用类型。</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>私钥密码</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>用户自定义私钥密码，根据界面提示的复杂度要求输入。</p>
<p>私钥密码用于对ProtectAgent软件包中的私钥文件进行加密，私钥文件<span style="color:#282B33;">用于代理主机与</span><span style="color:#282B33;">OceanProtect</span><span style="color:#282B33;">鉴权。请妥善保管此私钥密码，后续安装过程中会使用。</span></p>
<div class="note"><span class="notetitle"> 说明： </span><div class="notebody"><p>填写私钥密码后，<span>OceanProtect</span>将使用此处填写的私钥密码对ProtectAgent软件包中的私钥文件进行加密。</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="33.57%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.1 "><p><span>确认私钥密码</span></p>
</td>
<td class="cellrowborder" valign="top" width="66.43%" headers="mcps1.3.3.2.1.2.1.2.3.2.3.1.2 "><p>再次输入私钥密码。</p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li>单击<span class="uicontrol">“<span>确定</span>”</span>。<p>获取下载到的ProtectAgent软件包。</p>
<p>在Windows Server使用Internet Explorer 11下载ProtectAgent时，如果下载失败，可参考<a href="zh-cn_topic_0000001792550016.html">在Windows Server使用Internet Explorer 11下载ProtectAgent时下载失败</a>进行处理。</p>
</li></ol>
</p></li><li><span>确保主机与<span>OceanProtect</span>设备时间一致。</span><p><ul><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_li11744161816202">参考以下步骤查看<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_text3456181418112">OceanProtect</span>设备时间：<ol type="a" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001187942849_zh-cn_topic_0000001087149498_zh-cn_topic_0000001087149498_ol2172145813485"><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_li2026912191135">选择<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_zh-cn_topic_0000001311295305_zh-cn_topic_0000001149078659_uicontrol1098185683619">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_text157651936143415">系统</span> &gt; <span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_text49601653123416">基础设施</span> &gt; <span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_text112401684352">集群管理</span>”</span>。</li><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_li1626913191631">在<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_uicontrol13691645105219">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_text1763193125313">备份集群</span>”</span>页签的<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_uicontrol1050641575312">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001839143213_text133861121163513">本地集群节点</span>”</span>区域，单击节点名称。</li><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001187942849_zh-cn_topic_0000001087149498_zh-cn_topic_0000001087149498_li929117916361">在弹出的<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_uicontrol626919191738">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_text8269719131">节点详情</span>”</span>对话框中，查看当前设备时间。<p id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001187942849_zh-cn_topic_0000001087149498_zh-cn_topic_0000001087149498_p3985106145415">如果时间不一致，请修改代理主机时间，否则可能导致ProtectAgent安装失败。</p>
</li></ol>
</li></ul>
</p></li><li><span>安装ProtectAgent软件。</span><p><ol type="a"><li>以<strong>Administrator</strong>账户登录需要安装ProtectAgent的主机。</li><li>上传ProtectAgent软件包至主机并解压。<div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p>软件包名称中不能包含空格，否则ProtectAgent安装将失败。</p>
</div></div>
</li><li>进入软件包目录，安装软件。<ol class="substepthirdol"><li>如需指定用于注册的业务IP，请执行本步骤。否则，请直接跳转至<a href="#ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_li14880301717">3.c.ii</a>。<ol><li>进入“..\DataProtect_<em>xxx</em>_client_general_windows\DataProtect_<em>xxx</em>_client_general_windows\conf”目录，<em>xxx</em>为ProtectAgent的版本号。</li><li>打开“client.conf”文件，在“client.conf”文件末尾增加配置项<strong>eip=</strong><em>XXX.XXX.XXX.XXX</em>，其中<em>XXX.XXX.XXX.XXX</em>请替换为用于注册的业务IP。</li></ol>
</li><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_li14880301717"><a name="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_li14880301717"></a><a name="zh-cn_topic_0000001143474500_zh-cn_topic_0000001142182722_zh-cn_topic_0000001084775528_li14880301717"></a>进行软件安装。<ol><li>进入“..\DataProtect_<em>xxx</em>_client_general_windows\DataProtect_<em>xxx</em>_client_general_windows”目录，<em>xxx</em>为ProtectAgent的版本号。</li><li>双击<span class="uicontrol">“install.bat”</span>，根据回显提示完成软件安装。<ol type="a"><li>当回显如下信息时，请根据提示输入ProtectAgent软件的安装目录。如果不输入直接按<span class="uicontrol">“Enter”</span>，则默认安装在<span class="filepath">“C:”</span>。<pre class="screen">"You need to enter the installation path (directly press 'Enter' use default installation path C:)."
Please enter custom install path:</pre>
</li><li>当回显类似如下信息时，请确认主机与<span>OceanProtect</span>设备时间一致，并输入<span class="parmvalue">“y”</span>。<pre class="screen">The current host time and time zone are Thu 08/17/2023 17:17:34.87. Check whether the time and time zone are the same as those on DataBackup time:(y|n):
Your choice:</pre>
</li><li>当回显如下信息时，请输入<a href="#ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001143474500_li16856140134313">1.b</a>中设置的私钥密码。<pre class="screen">Please enter the private key password set on ProtectManager, you still have 3 chances:
Enter password:</pre>
</li><li>当回显如下信息时，设置<strong>rdadmin</strong>用户的密码。<pre class="screen">Add User rdadmin Enter password:</pre>
</li><li>对于1.6.0及后续版本，当回显如下信息时，请选择是否开启源端重删功能。<pre class="screen">Whether enable dataturbo service:(y|n):
Your choice:</pre>
<p>如果输入<span class="parmvalue">“y”</span>，则开启源端重删功能，请确保代理主机空闲内存大于2GB，系统会自动安装OceanStor DataTurbo客户端。支持源端重删的操作系统请查看<a href="https://info.support.huawei.com/storage/comp/#/oceanprotect" target="_blank" rel="noopener noreferrer">兼容性查询工具</a>。</p>
<p>如果输入<span class="parmvalue">“n”</span>，则不开启源端重删功能。在ProtectAgent安装完成后也可手动安装OceanStor DataTurbo客户端，具体操作请参考<a href="zh-cn_topic_0000001936780456.html">安装OceanStor DataTurbo客户端（适用于1.6.0及后续版本）</a>章节。</p>
<div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001936780456_p1942121419116">开启源端重删功能后，请在首次备份前将源端重删用户加到sudoers中，具体操作请参见<a href="zh-cn_topic_0000001792390228.html">添加源端重删用户到sudoers</a>。</p>
</div></div>
</li></ol>
<p>当回显如下信息时，表示安装ProtectAgent软件成功。</p>
<pre class="screen">The DataBackup ProtectAgent has been installed successfully.</pre>
</li></ol>
</li></ol>
</li></ol>
</p></li><li><span>主机安装ProtectAgent软件后，OceanProtect管理界面会自动发现该主机，执行如下步骤进行检查。</span><p><ol type="a"><li>选择<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_uicontrol08941439165212_1">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_text22651956143811_1">保护</span> &gt; 客户端”</span>。</li><li>查看已安装ProtectAgent的主机是否已存在于OceanProtect管理界面。<p>如果在OceanProtect管理界面上未发现已安装ProtectAgent的主机，请联系系统管理员为该用户进行资源授权。</p>
<ol class="substepthirdol"><li>选择<span class="uicontrol" id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_uicontrol08941439165212_2">“<span id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839142377_text22651956143811_2">保护</span> &gt; 客户端”</span>。</li><li>在该主机所在行，单击<span class="uicontrol">“<span>更多</span> &gt; <span>资源授权</span>”</span>。</li><li>将该主机授权给相应的用户。</li></ol>
</li></ol>
</p></li></ol><ol start="5"><li><span>重复以上步骤为其他代理主机安装ProtectAgent软件。</span><p><div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><ul id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_ul123173916548"><li id="ZH-CN_TOPIC_0000001839189353__zh-cn_topic_0000001839189313_li323123995417">代理主机注册成功后请等待5分钟再使用该代理主机。</li></ul>
</div></div>
</p></li></ol>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div></body>
</html>