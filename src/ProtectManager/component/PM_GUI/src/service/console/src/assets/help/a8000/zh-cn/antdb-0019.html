<!--
  This file is a part of the open-eBackup project.
  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  If a copy of the MPL was not distributed with this file, You can obtain one at
  http://mozilla.org/MPL/2.0/.
  
  Copyright (c) [2024] Huawei Technologies Co.,Ltd.
  
  THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
  EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
  MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  -->


<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="步骤7：执行备份">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="antdb-0012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="">
<meta name="DC.Publisher" content="20250306">
<meta name="prodname" content="csbs">
<meta name="documenttype" content="usermanual">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="antdb-0019">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>步骤7：执行备份</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="antdb-0019"></a><a name="antdb-0019"></a>

<h1 class="topictitle1">步骤7：执行备份</h1>
<div><p>执行备份前将需要保护的资源关联到指定SLA，系统将对这些资源按照SLA进行保护，并根据SLA周期性自动执行备份任务。如需立即执行一次备份任务时，可以通过手动备份实现。</p>
<div class="section"><h4 class="sectiontitle">注意事项</h4><ul><li>手动备份产生的副本保留时长按照SLA中的定义进行保留。</li><li>如果SLA中定义了复制策略或归档策略，则执行手动备份时，OceanProtect会按照SLA的定义执行一次复制或归档。</li><li>如果SLA中未定义日志备份，则无法自动执行日志备份。</li><li>请确保AntDB数据库实例可以正常运行，当AntDB数据库实例停止运行时，将会触发备份任务执行失败。</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">操作步骤</h4><ol><li><span>选择<span class="menucascade" id="antdb-0019__antdb-0014_zh-cn_topic_0000002199964685_menucascade19639111263113">“<span class="uicontrol" id="antdb-0019__antdb-0014_zh-cn_topic_0000002199964685_uicontrol263971233119">保护 &gt; 数据库 &gt; AntDB</span>”</span>。</span></li><li><span>选择需要保护的实例，单击<span class="uicontrol">“<span>保护</span>”</span>。</span><p><p>您也可以勾选多个数据库进行批量保护。</p>
</p></li><li><span>选择SLA。</span><p><p>您也可以单击<span class="uicontrol">“<span>创建</span>”</span>，创建新的SLA。</p>
<div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p><span>如果待保护的资源已设置WORM策略，为避免WORM策略冲突，请选择不包含WORM策略的SLA创建保护。</span></p>
</div></div>
</p></li><li><span>配置备份策略其他参数。</span><p><div class="p">相关参数说明如<a href="#antdb-0019__zh-cn_topic_0000001349147581_zh-cn_topic_0000001263775382_table354613271506">表1</a>所示。
<div class="tablenoborder"><a name="antdb-0019__zh-cn_topic_0000001349147581_zh-cn_topic_0000001263775382_table354613271506"></a><a name="zh-cn_topic_0000001349147581_zh-cn_topic_0000001263775382_table354613271506"></a><table cellpadding="4" cellspacing="0" summary="" id="antdb-0019__zh-cn_topic_0000001349147581_zh-cn_topic_0000001263775382_table354613271506" frame="border" border="1" rules="all"><caption><b>表1 </b>备份策略其他参数说明</caption><colgroup><col style="width:26.939999999999998%"><col style="width:73.06%"></colgroup><thead align="left"><tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row15195123413819"><th align="left" class="cellrowborder" valign="top" width="26.939999999999998%" id="mcps1.3.3.2.4.2.1.2.2.3.1.1"><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p12195143420389">参数</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="73.06%" id="mcps1.3.3.2.4.2.1.2.2.3.1.2"><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p3195123443814">说明</p>
</th>
</tr>
</thead>
<tbody><tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row03245215333"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_foc_gud_0019_p91791444679">指定目标位置</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><div class="p" id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p1891714203713">请指定备份副本的目标存储位置。<ul id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_ul3832679403"><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_li299019528162">备份存储单元：对应于备份集群节点。选择备份存储单元后，副本将存储至该存储单元。存储单元容量不足时，备份任务将会失败。<p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_p36749546164"><a name="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_li299019528162"></a><a name="antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_li299019528162"></a>创建备份存储单元的操作请参考<span id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_cite114441740141613">《OceanProtect DataBackup 1.5.0-1.6.0 集群高可用特性指南》</span>中的“管理备份存储单元”章节。</p>
</li><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_zh-cn_topic_0000001839143189_li168151656101610"><span class="parmvalue" id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_parmvalue142224995111">“备份存储单元组”</span>：是备份存储单元的集合。选择备份存储单元组后，系统根据存储单元组的存储策略自动选择备份目标存储单元。<p id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_p15126135815168">创建备份存储单元组的操作请参考<span id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_cite961778916">《OceanProtect DataBackup 1.5.0-1.6.0 集群高可用特性指南》</span>中的“（可选）创建备份存储单元组”章节。</p>
</li></ul>
</div>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row419543420389"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_foc_gud_0019_p6195834193813">限速策略</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p7894155910582">备份任务平均每秒最大传输的数据量。</p>
<p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p5195234183811">选择<a href="antdb-0016.html">步骤4：（可选）创建限速策略</a>。</p>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row18195103413385"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><div class="p" id="antdb-0019__antdb-0018_foc_gud_0019_p751114511956">源端重删<div class="note" id="antdb-0019__antdb-0018_foc_gud_0019_zh-cn_topic_0000002164820434_note1141182723518"><span class="notetitle"> 说明： </span><div class="notebody"><p id="antdb-0019__antdb-0018_foc_gud_0019_zh-cn_topic_0000002164820434_p164111271351">仅OceanProtect X系列备份一体机和OceanProtect E1000（备份存储为OceanProtect）支持配置此参数。</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><div class="p" id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p8195183403816">开启后，可以减少传输的数据量，但会增加客户端的资源占用。<div class="note" id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_note8885112682911"><span class="notetitle"> 说明： </span><div class="notebody"><ul id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_ul5885426132914"><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li10885172616299">由于同一个客户端只能和一个存储单元建链，如果开启源端重删，<span class="parmname" id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_parmname1288482662917">“指定目标位置”</span>请选择<span class="parmvalue" id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_parmvalue118843260299">“备份存储单元”</span>。否则，由于智能均衡可能会选择到未建链的存储单元，导致源端重删启用失败。如果不同受保护对象关联了不同SLA，且SLA中指定不同的备份存储单元，请为受保护对象选择不同客户端，否则将会导致部分备份任务源端重删启用失败。</li><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li9885182662911">如果客户端已经与一个存储单元建链，当该客户端未执行源端重删备份任务时，可以在客户端所在主机上执行<strong id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_b9845163710167">dataturbo delete storage_object storage_name=</strong><em id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_i19447038131614">?</em>命令（命令中的<strong id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_b1050314315162">storage_name=</strong><em id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_i1237554410161">?</em>可以通过<strong id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_b11885726112912">dataturbo show storage_object</strong>命令查询），删除与存储单元的源端重删链接。再选择该客户端执行源端重删备份任务，则可以成功与新的存储单元建链。</li><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li11885142615297">请参考<a href="https://info.support.huawei.com/storage/comp/#/oceanprotect" target="_blank" rel="noopener noreferrer">OceanProtect兼容性查询</a>工具查看客户端所在主机的操作系统类型是否支持源端重删。若不支持，配置源端重删后将不会生效。</li><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li7883549153219">若使用内置客户端（即客户端合并部署到<span id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_text13835155817114">OceanProtect</span>）进行备份，配置源端重删后将不会生效。</li></ul>
</div></div>
</div>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row728919591711"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><div class="p" id="antdb-0019__antdb-0018_foc_gud_0019_p1531171813176">通用压缩<div class="note" id="antdb-0019__antdb-0018_foc_gud_0019_zh-cn_topic_0000002164820434_note0148155184019"><span class="notetitle"> 说明： </span><div class="notebody"><p id="antdb-0019__antdb-0018_foc_gud_0019_zh-cn_topic_0000002164820434_p176371043184114">仅OceanProtect E6000备份一体机支持设置此参数。</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p20725132231720">开启通用压缩可以将业务数据直接进行压缩后再写入存储空间，达到节约存储空间提升备份效率的目的。</p>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_row4400939115110"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_p440123912514">线程数</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_p144011339175118">执行备份任务时，拷贝文件的线程池配置的线程数。取值范围为1~256。</p>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_row23158462411"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_foc_gud_0019_p1835141211302">任务超过时间窗告警</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_p8315194674119">开启后任务执行超过时间窗将发送告警，告警需手动清除。</p>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row1984716333155"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_foc_gud_0019_p15195123493811">任务失败告警</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p1919563413813">开启后，任务执行失败后自动发送告警，下次任务成功后告警自动清除。</p>
</td>
</tr>
<tr id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_row141951534103816"><td class="cellrowborder" valign="top" width="26.939999999999998%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p id="antdb-0019__antdb-0018_foc_gud_0019_p2195134113818">失败后自动重试</p>
</td>
<td class="cellrowborder" valign="top" width="73.06%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p168014618916">开启后，周期性备份任务失败后系统自动重试。</p>
<div class="p" id="antdb-0019__antdb-0018_zh-cn_topic_0000002001372228_p6686112353917">支持重试次数为1~5次，等待时长为1~30分钟。如设置为重试3次，等待5分钟，即每5分钟后重试一次，总共重试3次。<div class="note" id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_note139701345152818"><span class="notetitle"> 说明： </span><div class="notebody"><ul id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_ul264071314279"><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li1864001332715">自动重试时系统会创建一个新的备份任务，如果该备份任务不在设定的时间窗内则不会执行，此次备份失败。</li><li id="antdb-0019__antdb-0018_zh-cn_topic_0000002164820434_li116401113172713">该功能仅在周期性备份时生效。手动发起备份任务，任务失败无法自动重试。</li></ul>
</div></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</p></li><li><span>单击<span class="uicontrol">“确定”</span>。</span><p><p>如果当前系统时间已晚于SLA首次备份的开始时间，可以在弹出的对话框中选择立即执行手动备份或者根据SLA中设置的备份策略周期性自动执行备份。</p>
</p></li><li><strong>可选：</strong><span>执行手动备份。</span><p><div class="p">当需要立即执行一次备份任务时，可以执行以下操作进行手动备份。否则，可跳过本步骤。<ol type="a"><li>在需要备份的数据库所在行单击<span class="uicontrol">“<span>更多</span> &gt; <span>手动备份</span>”</span>。<div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p>支持选择多个资源批量进行手动备份。勾选多个资源，在页面左上角选择<span class="uicontrol">“<span>更多</span> &gt; <span>手动备份</span>”</span>。</p>
</div></div>
</li><li>设置手动备份产生的副本名称。<p>如果您不设置，系统默认设置副本名称为：backup_时间戳。</p>
</li><li>选择保护策略：<span>全量备份</span>或<span>日志备份</span>。<div class="note"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p><span>如果选择的保护策略与关联的SLA中配置的保护策略不一致，则WORM配置不生效。</span></p>
</div></div>
</li><li>单击<span class="uicontrol">“确定”</span>。</li></ol>
</div>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="antdb-0012.html">备份AntDB</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div></body>
</html>