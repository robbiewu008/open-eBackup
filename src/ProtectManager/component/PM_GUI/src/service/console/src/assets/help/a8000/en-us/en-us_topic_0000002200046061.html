<!--
  This file is a part of the open-eBackup project.
  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  If a copy of the MPL was not distributed with this file, You can obtain one at
  http://mozilla.org/MPL/2.0/.
  
  Copyright (c) [2024] Huawei Technologies Co.,Ltd.
  
  THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
  EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
  MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  -->


<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Step 9: Performing Backup">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="en-us_topic_0000002164805012.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="">
<meta name="DC.Publisher" content="20250306">
<meta name="prodname" content="csbs">
<meta name="documenttype" content="usermanual">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TOPIC_0000002200046061">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>Step 9: Performing Backup</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="EN-US_TOPIC_0000002200046061"></a><a name="EN-US_TOPIC_0000002200046061"></a>

<h1 class="topictitle1">Step 9: Performing Backup</h1>
<div><p>Before performing backup, you need to associate the resources to be protected with a specified SLA policy. The system protects the resources based on the SLA policy and periodically performs backup jobs based on the SLA policy. You can perform a backup job immediately through manual backup.</p>
<div class="section"><h4 class="sectiontitle">Precautions</h4><ul><li>For a NAS share discovered through device registration, if the NAS share has authentication information, complete the configuration by referring to <a href="en-us_topic_0000002200046025.html">(Optional) Step 3: Configuring NAS Share Information (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>. Otherwise, the backup fails.</li><li>For an NFS share, ensure that the current device has the read and write permissions on the NFS share directory and the <strong>no_root_squash</strong> option is enabled. For details about how to configure NFS share access permissions, see <a href="en-us_topic_0000002164645244.html">Step 4: Configuring Access Permissions (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>.</li><li>For a CIFS share, ensure that the current device has the read and write permissions on the CIFS share directory. You are advised to use a user in the Administrator group for backup. Otherwise, only files and directories whose read and write permissions are granted to the device can be backed up. For details about how to configure CIFS share access permissions, see <a href="en-us_topic_0000002164645244.html">Step 4: Configuring Access Permissions (Applicable to OceanStor V5/OceanStor Pacific/NetApp ONTAP)</a>.</li></ul>
<ul><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_li147271733132211">During the execution of a manual backup job, the parameters (except <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_uicontrol970711415461"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_text1370618444612"><strong>Automatic Retry</strong></span></b></span>) defined in the SLA, such as <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_uicontrol10707164144616"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_text1770784134614"><strong>Rate Limiting Policies</strong></span></b></span> and <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_uicontrol970710414466"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_text2070784164616"><strong>Automatic Indexing</strong></span></b></span>, will take effect.</li><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_li31561026997">Copies generated by manual backup are retained for the duration defined in the SLA.</li></ul>
<ul><li>If a replication or archive policy has been defined in the SLA, the system will perform replication or archiving once based on the SLA when you perform manual backup.</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Procedure</h4><ol><li><span>Choose <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_uicontrol79081114124111"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_text99081414144119"><strong>Protection</strong></span> &gt; File Systems &gt; NAS Shares</b></span>.</span><p><div class="note" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_note397892312184"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_p5978112341818">For 1.5.0, choose <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_uicontrol129783237180"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002199964685_text10978172391818"><strong>Protection</strong></span> &gt; File Services &gt; NAS Shares</b></span>.</p>
</div></div>
</p></li><li><span>In the row of the target NAS share, choose <span class="uicontrol"><b><span><strong>More</strong></span> &gt; <span><strong>Protect</strong></span></b></span>.</span></li><li><span>Select the created SLA.</span><p><p>You can also click <span class="uicontrol"><b>Create</b></span> to create an SLA.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_p125947145711"><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_ph1413818422327">If a WORM policy has been configured for the resources to be protected, select an SLA without a WORM policy to avoid WORM policy conflicts.</span></p>
</div></div>
</p></li><li><span>Set advanced parameters. <a href="#EN-US_TOPIC_0000002200046061__table10589227135411">Table 1</a> describes the related parameters.</span><p>
<div class="tablenoborder"><a name="EN-US_TOPIC_0000002200046061__table10589227135411"></a><a name="table10589227135411"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TOPIC_0000002200046061__table10589227135411" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Advanced parameters</caption><colgroup><col style="width:20.419999999999998%"><col style="width:79.58%"></colgroup><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="20.419999999999998%" id="mcps1.3.3.2.4.2.1.2.3.1.1"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="79.58%" id="mcps1.3.3.2.4.2.1.2.3.1.2"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><span><strong>Channels</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p id="EN-US_TOPIC_0000002200046061__p1434813260155">Number of subjobs that can be concurrently executed on the clients when restoration is executed. The default number of channels for the NAS share is <strong id="EN-US_TOPIC_0000002200046061__b75076301131">10</strong>, and the maximum number is <strong id="EN-US_TOPIC_0000002200046061__b10507030131313">40</strong>.</p>
<p id="EN-US_TOPIC_0000002200046061__p758862414551">More channels indicate better backup performance and a higher NAS share access rate. However, more CPUs and memory of the client will be occupied. Each channel occupies about 200 MB memory.</p>
<p id="EN-US_TOPIC_0000002200046061__p19996163610556">For 1.5.0, you are advised to reduce the number of channels due to limited container resources if the client is deployed on the <span id="EN-US_TOPIC_0000002200046061__text1999610369555">OceanProtect</span>.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><span><strong>Small File Aggregation</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>After this function is enabled, the system aggregates multiple small files in the same directory into a large file to improve backup efficiency. In the scenario where incremental backup is included in the SLA: if forever incremental (synthetic full) backup is not configured in the SLA, small file aggregation cannot be disabled; if forever incremental (synthetic full) backup is configured in the SLA, small file aggregation cannot be enabled. If small file aggregation is enabled for a resource, ransomware detection is not supported for copies of the resource. This function is not recommended if the number of subdirectories and files in a single directory exceeds 1 million.</p>
<p>You need to set the following two parameters:</p>
<ul><li><span><strong>File Size After Aggregation</strong></span>: size of the aggregated file. The value can be 1024 KB or 4096 KB (recommended).</li><li><span><strong>Maximum Aggregated File Size</strong></span>: maximum size of the file to be aggregated. The value can be 128 KB, 256 KB, 1024 KB (recommended), or 4096 KB.</li></ul>
<p><span><strong>For small file aggregation, the file size after aggregation must be greater than or equal to the size of the largest file aggregated.</strong></span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><span><strong>SMB Hard Link Protection</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>This option is enabled by default. If too many files exist in the same directory of the NAS share dataset to be protected, the backup job may fail. It is recommended that this option be disabled in this scenario.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><span><strong>SMB ACL Protection</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>This option is enabled by default. If too many files exist in the same directory of the NAS share dataset to be protected, the backup job may fail. It is recommended that this option be disabled in this scenario.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Hot Data Backup</strong></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>After this function is enabled, only files whose modification time is later than the specified time point are backed up. The specified time point refers to the historical time point which is ahead of the backup time point by a period of time you set.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Cold Data Backup</strong></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>After this function is enabled, only files whose modification time is earlier than the specified time point are backed up. The specified time point refers to the historical time point which is ahead of the backup time point by a period of time you set.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Secure Archiving</strong></p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_en-us_topic_0000002164660718_ul15432342582"><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_en-us_topic_0000002164660718_li94333410589"><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_en-us_topic_0000002164660718_ph03981201700">This function is available only in 1.6.0 and later versions.</span></li><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_en-us_topic_0000002164660718_li4285123675814"><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_en-us_topic_0000002164660718_ph10967204817175">Only the OceanProtect X series backup appliances and OceanProtect E1000 support this function.</span></li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><div class="p">This parameter is displayed when the selected SLA contains archive policies. If this option is selected, only backup copies that are detected to be uninfected during ransomware detection are archived.<div class="note" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_note1550211211513"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_p10502162125111">You need to click <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_b810018188319">Configure</strong> to set the ransomware protection policy for the resource to be protected if the following conditions are met: <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_b17329127414">Archive Time</strong> is not set to <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_b938619243">Immediately after successful backup</strong> or <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_b84761821247">Archive Policy</strong> is not set to <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_b0492172712416">Only the latest copy</strong> in the SLA archive policy, and the ransomware protection policy is not set. For details, see "Creating a Ransomware Protection and WORM Policy" in the <i><cite id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200007033_cite15733201398">OceanProtect DataBackup 1.5.0-1.6.0 Data Backup Feature Guide (Ransomware Protection for Copies)</cite></i>.</p>
</div></div>
</div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Auto Indexing of Backup Copies</strong></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p><strong>Auto Indexing of Backup Copies</strong></p>
<p>This function is disabled by default. If a VM or VM group is selected for protection and the disks to be backed up contain system disks, the system automatically creates indexes for backup copies after this function is enabled. When using such a copy for restoration, you can select one or more files in the copy for restoration and search for files, directories, or links in the copy.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul><li>Only 1.6.0 and later versions support this parameter.</li><li>Indexes need to occupy backup storage space. If the total number of index files in the system exceeds 1 billion, perform operations by referring to "Failed to Create a Copy Index" in the <i><cite>OceanProtect <span>Appliance 1.5.0-1.6.0DataBackup 1.6.0</span> Troubleshooting</cite></i>.</li></ul>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Automatic Indexing of Object Storage Archive Copies</strong></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><p>Set the <strong>Automatic Indexing of Object Storage Archive Copies</strong> function.</p>
<p>This function is disabled by default. This parameter is displayed when <strong>Archive Storage Type</strong> is set to <span class="parmvalue"><b>Object Storage</b></span>. This function cannot be disabled after it is enabled. After this function is enabled, the system automatically creates file indexes for copies. After indexes are created, one or more files can be restored. You can also manually create indexes for copies.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_ul023110513259"><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_li132316517255">Only 1.6.0 and later versions support this parameter.</li><li id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_li92931654182518">Indexes need to occupy backup storage space. If the total number of index files in the system exceeds 1 billion, perform operations by referring to "Failed to Create a Copy Index" in the <i><cite id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_cite677218601619">OceanProtect <span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200045985_en-us_topic_0000001839187081_en-us_topic_0000001792520410_en-us_topic_0000001792502994_ph187704762018">Appliance 1.5.0-1.6.0DataBackup 1.6.0</span> Troubleshooting</cite></i>.</li></ul>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="20.419999999999998%" headers="mcps1.3.3.2.4.2.1.2.3.1.1 "><p><strong>Automatic Indexing of Copies Archived to Tapes</strong></p>
</td>
<td class="cellrowborder" valign="top" width="79.58%" headers="mcps1.3.3.2.4.2.1.2.3.1.2 "><ul><li>Set the <strong>Automatic Indexing of Copies Archived to Tapes</strong> function.<p>This function is disabled by default. This parameter is displayed when <strong>Archive Storage Type</strong> is set to <span class="parmvalue"><b>Tape Library</b></span>. If you want to view detailed data in archive copies or save the storage space occupied during restoration, enable this function. After this function is enabled, the system automatically creates file indexes for copies. After indexes are created, one or more files can be restored.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul><li>Only 1.6.0 and later versions support this parameter.</li><li>If <strong>Automatic Indexing of Copies Archived to Tapes</strong> is disabled, the copies archived to tapes cannot be directly restored to the production storage. Instead, a temporary file system is created on the <span>OceanProtect</span>, occupying backup storage space. After the restoration job is complete, the temporary file system is automatically cleared and reclaimed.</li></ul>
</div></div>
</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</p></li><li><span>Click <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_uicontrol23691650677"><b>OK</b></span>.</span><p><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_en-us_topic_0000001656691397_p25041111535">If the current system time is later than the start time of the first backup specified in the SLA, you can select <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_b9624185216713">Execute manual backup now</strong> in the dialog box that is displayed or choose to perform automatic backup periodically based on the backup policy set in the SLA.</p>
</p></li><li><strong>Optional: </strong><span>Perform manual backup.</span><p><div class="p">If you want to execute a backup job immediately, perform manual backup through the following operations. Otherwise, skip this step.<ol type="a"><li>In the row of the target resource, choose <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_b146814226353">More</strong> &gt; <span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_text18439122416533"><strong>Manual Backup</strong></span>.<div class="note" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_note1527151103"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_en-us_topic_0000001607531736_p870125314544">You can select multiple resources to perform manual backup in batches. Select multiple protected resources and choose <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_b1657653183519">More</strong> &gt; <span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_text122852865419"><strong>Manual Backup</strong></span> in the upper left corner of the resource list.</p>
</div></div>
</li><li>Set the name of the copy generated during manual backup.<p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_p444210492470">If this parameter is left unspecified, the system sets the copy name to <strong id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_b17709174711816">backup_</strong><em id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_i1371044717814">Timestamp</em> by default.</p>
</li><li>Select a protection policy.<ul><li>If <span><strong>Small File Aggregation</strong></span> is not configured for NAS share protection, the protection policy can be set to <span><strong>Full Backup</strong></span> or <span><strong>Forever Incremental (Synthetic Full) Backup</strong></span>.</li><li>If <span><strong>Small File Aggregation</strong></span> is configured for NAS share protection, the protection policy can be set to <span><strong>Full Backup</strong></span> or <span><strong>Incremental Backup</strong></span>.</li></ul>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_p13522118194919"><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_ph19374310343">If the selected protection policy is different from that configured in the associated SLA for 1.6.0 and later versions, the WORM configuration does not take effect.</span></p>
</div></div>
</li><li>Click <span class="uicontrol" id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_uicontrol1662615410817"><b><span id="EN-US_TOPIC_0000002200046061__en-us_topic_0000002200146973_text13625854687"><strong>OK</strong></span></b></span>.</li></ol>
</div>
</p></li></ol>
<p></p>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="en-us_topic_0000002164805012.html">Backing Up a NAS Share</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div></body>
</html>