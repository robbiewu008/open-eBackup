<!--
  This file is a part of the open-eBackup project.
  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  If a copy of the MPL was not distributed with this file, You can obtain one at
  http://mozilla.org/MPL/2.0/.
  
  Copyright (c) [2024] Huawei Technologies Co.,Ltd.
  
  THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
  EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
  MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  -->


<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Step 6: Performing Backup">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="Files-0008_0.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="30-OceanProtect Appliance 1.5.0-1.6.0 Help Center">
<meta name="DC.Publisher" content="20241029">
<meta name="prodname" content="csbs">
<meta name="documenttype" content="usermanual">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="Files-0014_0">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>Step 6: Performing Backup</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="Files-0014_0"></a><a name="Files-0014_0"></a>

<h1 class="topictitle1">Step 6: Performing Backup</h1>
<div><p>Before performing backup, you need to associate the resources to be protected with a specified SLA. The system protects the resources and periodically executes backup jobs based on the SLA. You can perform a backup job immediately through manual backup.</p>
<div class="section"><h4 class="sectiontitle">Precautions</h4><ul><li>During manual backup, the parameters (except <span class="uicontrol"><b><span><strong>Automatic Retry</strong></span></b></span>) defined in the SLA are applied to the manual backup job.</li><li>Copies generated by manual backup are retained for the period defined in the SLA.</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Procedure</h4><ol><li><span>Choose <span class="uicontrol" id="Files-0014_0__en-us_topic_0000001839142377_uicontrol1535113494115"><b><span id="Files-0014_0__en-us_topic_0000001839142377_text735434144116"><strong>Protection</strong></span> &gt; File Systems &gt; Filesets</b></span>.</span><p><div class="note" id="Files-0014_0__en-us_topic_0000001839142377_note12707194325517"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="Files-0014_0__en-us_topic_0000001839142377_p370854395513">For 1.5.0, choose <span class="uicontrol" id="Files-0014_0__en-us_topic_0000001839142377_uicontrol117931445568"><b><span id="Files-0014_0__en-us_topic_0000001839142377_text197938425615"><strong>Protection</strong></span> &gt; Bare Metal &gt; Filesets</b></span>.</p>
</div></div>
</p></li><li><span>On the <strong>Filesets</strong> tab page, select the fileset to be protected and click <span class="uicontrol"><b><span><strong>Protect</strong></span></b></span>.</span><p><p>You can choose multiple filesets for batch protection.</p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Only filesets with the same OS type can be protected in batches.</p>
</div></div>
</p></li><li><span>Select an SLA.</span><p><div class="p" id="Files-0014_0__en-us_topic_0000001964713008_p16181740836">You can also click <span class="uicontrol" id="Files-0014_0__en-us_topic_0000001964713008_uicontrol169554520714"><b><span id="Files-0014_0__en-us_topic_0000001964713008_text179554516717"><strong>Create</strong></span></b></span> to create an SLA.<div class="note" id="Files-0014_0__en-us_topic_0000001964713008_note25947145710"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="Files-0014_0__en-us_topic_0000001964713008_p125947145711"><span id="Files-0014_0__en-us_topic_0000001964713008_ph1413818422327">If a WORM policy has been configured for the resources to be protected, select an SLA without a WORM policy to avoid WORM policy conflicts.</span></p>
</div></div>
</div>
</p></li><li id="Files-0014_0__li164660725814"><a name="Files-0014_0__li164660725814"></a><a name="li164660725814"></a><span>Configure fileset protection advanced parameters.</span><p><div class="p"><a href="#Files-0014_0__table354613271506">Table 1</a> describes the related parameters.
<div class="tablenoborder"><a name="Files-0014_0__table354613271506"></a><a name="table354613271506"></a><table cellpadding="4" cellspacing="0" summary="" id="Files-0014_0__table354613271506" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Fileset protection advanced parameters</caption><colgroup><col style="width:19.75%"><col style="width:80.25%"></colgroup><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="19.75%" id="mcps1.3.3.2.4.2.1.2.2.3.1.1"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="80.25%" id="mcps1.3.3.2.4.2.1.2.2.3.1.2"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Channels</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>The more the channels, the better the backup performance. However, more memory of the production host will be occupied. Each channel occupies about 200 MB memory. The value of this parameter ranges from 1 to 40.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Consistent Backup</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, consistent backup is performed on filesets to ensure data consistency.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul><li>Linux OS:<p>Consistent backup supports only LVM volumes. You can create a snapshot for the LVM volume to which the path selected for the backup fileset belongs and back up data based on the snapshot volume to achieve consistent backup. The snapshot volume created during the backup job is mounted to a subdirectory in <strong>/opt/lvm-snapshots/</strong>. After the backup job is complete, the snapshot volume is deleted and the <strong>/opt/lvm-snapshots</strong> directory is retained.</p>
<p>When creating a snapshot for an LVM volume, ensure that the remaining space of the volume group to which the LVM volume belongs is greater than 5% of the space of the LVM volume where the backup is performed. Otherwise, the snapshot fails to be created and the backup job is converted to a non-consistent backup job. If the backup job is converted to a non-consistent backup job, a message is displayed in the job details. Check the disk space where the protection path resides and the space of the logical volume group by referring to <a href="en-us_topic_0000002050777633.html">After Consistent Backup Is Enabled, Snapshots Cannot Be Created Due to Insufficient Logical Volume Space, and the Backup Job Is Converted to Non-consistent Backup (for Linux OS)</a>, and expand the capacity.</p>
</li><li>AIX OS:<p>The snapshot volume created during the backup job is mounted to a subdirectory in <strong>/opt/jfs_snapshots/</strong>. After the backup job is complete, the snapshot volume is deleted and the <strong>/opt/jfs_snapshots</strong> directory is retained.</p>
<p>The remaining space of the volume group where the protection path resides must be greater than 5% of the volume space.</p>
</li><li>Windows OS:<p>The snapshot volume created in the backup job is mounted to a subdirectory in <strong>C:\vss_snapshots\</strong>. After the backup job is complete, the snapshot volume is deleted, and the <strong>C:\vss_snapshots</strong> directory is retained.</p>
<p>The free space of the disk where the protection path resides must be greater than 5% of the disk space.</p>
</li><li>Solaris OS:<p>After consistent backup is enabled, the backup job will fail if the path length of a file or directory to be backed up exceeds 972 characters due to the zettabyte file system (ZFS) snapshot mechanism.</p>
</li></ul>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Percentage of Space Reserved for Snapshots</strong></span></p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>Only 1.6.0 and later versions support this parameter.</p>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>Percentage of the space reserved for snapshots during data backup to the space of the volume where the protection path resides.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Cross-File-System Backup</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, data of multiple file systems (except CIFS share file systems) mounted to the fileset directory will be backed up. Otherwise, only data of the file system where the current directory resides will be backed up.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Backup NFS</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>This parameter is displayed only when the host runs a non-Windows OS. After this function is enabled, all NFS share file system data mounted to the fileset directory is backed up. The performance may be affected if the file system data volume is large.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Backup SMB</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>This parameter is displayed only when the host runs Windows. After this function is enabled, all CIFS share file system data mounted to the fileset directory is backed up. The performance may be affected if the file system data volume is large.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Continuous Protection After File/Directory Backup Failure</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, if a file or directory in the fileset fails to be backed up, the backup job continues. Otherwise, the backup job ends.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Sparse File Detection</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, the system backs up sparse files based on the actual data volume, improving backup efficiency.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Small File Aggregation</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, the system aggregates multiple small files in the same directory into a large file to improve backup efficiency. If incremental backup is configured for the SLA, small file aggregation cannot be disabled. If forever incremental (synthetic full) backup is configured for the SLA, small file aggregation cannot be enabled.</p>
<ul><li><strong>File Size After Aggregation</strong>: indicates the size of the aggregated file generated after multiple small files are aggregated.</li><li><strong>Maximum Aggregated File Size</strong>: indicates the maximum size of a small file that can be aggregated.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><span><strong>Execution Script</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>You can configure <strong>Script to Run Before Backup</strong>, <strong>Script to Run upon Backup Success</strong>, and <strong>Script to Run upon Backup Failure</strong> as required. When the message "ProtectAgent started executing the prerequisite task." is displayed during a backup job, the configured script is executed in the corresponding scenario.</p>
<p>You can also place the execution script in any directory and enter the absolute path of the execution script.</p>
<ul><li>If the non-Windows OS is used, enter the script name, which ends with <strong>.sh</strong>. Ensure that the script is stored in <span class="filepath"><b>DataBackup/ProtectClient/ProtectClient-E/sbin/thirdparty</b></span> in the ProtectAgent installation directory.</li><li>If the Windows OS is used, enter the script name, which ends with <strong>.bat</strong>. Ensure that the script is stored in <span class="filepath"><b>DataBackup\ProtectClient\ProtectClient-E\bin\thirdparty</b></span> in the ProtectAgent installation directory.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><div class="p"><strong id="Files-0014_0__vmware_gud_0028_0_b1822015259583">Auto Indexing of Backup Copies</strong><div class="note" id="Files-0014_0__vmware_gud_0028_0_note17447255201"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="Files-0014_0__vmware_gud_0028_0_vmware_gud_0028_0_p168431642184919">Only 1.6.0 and later versions support this parameter.</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>After this function is enabled, the system automatically creates file indexes for copies. After indexes are created, files, directories, or links in copies can be searched. You can also manually create indexes for copies.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="Files-0014_0__vmware_gud_0028_0_nas_s_0016_p0743109201911">Indexes occupy backup storage space. If the number of index files in the system exceeds 1 billion, perform operations by referring to "Failed to Create a Copy Index" in the <i><cite id="Files-0014_0__vmware_gud_0028_0_cite165034152574">OceanProtect DataBackup 1.5.0-1.6.0 Troubleshooting</cite></i>.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><div class="p"><strong>Automatic Indexing of Object Storage Archive Copies</strong><div class="note" id="Files-0014_0__note847812296466"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="Files-0014_0__p1847811298467">Only 1.6.0 and later versions support this parameter.</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>For filesets, NAS file systems, and NAS shares, this parameter is displayed when <strong>Archive Storage Type</strong> is set to <span class="parmvalue"><b>Object Storage</b></span>. This parameter is not displayed for other applications.</p>
<p>This function cannot be disabled after it is enabled. The system automatically creates file indexes for copies. After the indexes are created, one or more files can be restored.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>Indexes occupy backup storage space. If the total number of index files in the system exceeds 1 billion, perform operations by referring to "Failed to Create a Copy Index" in the<i><cite>OceanProtect <span>Appliance 1.5.0-1.6.0 DataBackup 1.6.0</span> Troubleshooting</cite></i>.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="19.75%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.1 "><p><strong>Automatic Indexing of Copies Archived to Tapes</strong></p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="Files-0014_0__files-0014_0_p1847811298467">Only 1.6.0 and later versions support this parameter.</p>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="80.25%" headers="mcps1.3.3.2.4.2.1.2.2.3.1.2 "><p>This function is disabled by default. This parameter is displayed when <strong>Archive Storage Type</strong> is set to <span class="parmvalue"><b>Tape Library</b></span>. If you want to view detailed data in archive copies or save the storage space occupied during restoration, enable this function. After this function is enabled, the system automatically creates file indexes for copies. After the indexes are created, one or more files can be restored.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>If automatic indexing of copies archived to tapes is disabled, the copies archived to tapes cannot be directly restored to the production storage. Instead, a temporary file system is created on the <span>OceanProtect</span>, occupying backup storage space. After the restoration job is complete, the temporary file system is automatically cleared and reclaimed.</p>
</div></div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</p></li><li><span>Click <span class="uicontrol" id="Files-0014_0__en-us_topic_0000001964713008_uicontrol23691650677"><b>OK</b></span>.</span><p><p id="Files-0014_0__en-us_topic_0000001964713008_en-us_topic_0000001656691397_p25041111535">If the current system time is later than the start time of the first backup specified in the SLA, you can select <strong id="Files-0014_0__en-us_topic_0000001964713008_b9624185216713">Execute manual backup now</strong> in the dialog box that is displayed or choose to perform automatic backup periodically based on the backup policy set in the SLA.</p>
</p></li><li><span>Perform manual backup.</span><p><p>If you want to execute a backup job immediately, perform manual backup through the following operations. Otherwise, skip this step.</p>
<ol type="a"><li>Choose <span class="uicontrol"><b><span><strong>Protection</strong></span> &gt; File Systems &gt; Filesets</b></span>.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>For 1.5.0, choose <span class="uicontrol"><b><span><strong>Protection</strong></span>Application Backup &gt; Bare Metal &gt; Filesets</b></span>.</p>
</div></div>
</li><li>Choose <span class="uicontrol"><b><span><strong>More</strong></span> &gt; <span><strong>Manual Backup</strong></span></b></span> in the row where the fileset to be backed up is located.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>You can select multiple resources to perform manual backup in batches. Select multiple resources and choose <span class="uicontrol"><b><span><strong>More</strong></span> &gt; <span><strong>Manual Backup</strong></span></b></span>.</p>
</div></div>
</li><li>Set the name of the copy generated during manual backup.<p>If this parameter is left unspecified, the system sets the name to <strong>backup_</strong><em>Timestamp</em> by default.</p>
</li><li>Select a protection policy, which can be <strong>Full Backup</strong>, <strong>Incremental Backup</strong>, or <strong>Forever Incremental (Synthetic Full) Backup</strong>.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul><li><strong>Forever Incremental (Synthetic Full) Backup</strong> is displayed only when <span><span><strong>Set as Forever Incremental (Synthetic Full) Backup</strong></span> is selected during incremental backup policy creation.</span></li><li><span>For 1.6.0 and later versions, if the selected protection policy is different from that configured in the associated SLA, the WORM configuration does not take effect.</span></li></ul>
</div></div>
</li><li>Click <span class="uicontrol"><b><span><strong>OK</strong></span></b></span>.</li></ol>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="Files-0008_0.html">Backing up a Fileset</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div></body>
</html>