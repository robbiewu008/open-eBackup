<!--
  This file is a part of the open-eBackup project.
  This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.0.
  If a copy of the MPL was not distributed with this file, You can obtain one at
  http://mozilla.org/MPL/2.0/.
  
  Copyright (c) [2024] Huawei Technologies Co.,Ltd.
  
  THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
  EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
  MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.
  -->

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="DC.Type" content="topic">
  <meta name="DC.Title" content="An Error Message Indicating new_collation_enabled Mismatch Is Displayed During Restoration">
  <meta name="product" content="">
  <meta name="DC.Relation" scheme="URI" content="en-us_topic_0000002164664398.html">
  <meta name="prodname" content="">
  <meta name="version" content="">
  <meta name="brand" content="">
  <meta name="DC.Publisher" content="20250306">
  <meta name="prodname" content="csbs">
  <meta name="documenttype" content="usermanual">
  <meta name="DC.Format" content="XHTML">
  <meta name="DC.Identifier" content="EN-US_TOPIC_0000002200065113">
  <meta name="DC.Language" content="en-us">
  <link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
  <title>An Error Message Indicating new_collation_enabled Mismatch Is Displayed During Restoration</title>
 </head>
 <body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px">
  <a name="EN-US_TOPIC_0000002200065113"></a><a name="EN-US_TOPIC_0000002200065113"></a>
  <h1 class="topictitle1">An Error Message Indicating new_collation_enabled Mismatch Is Displayed During Restoration</h1>
  <div>
   <div class="section">
    <h4 class="sectiontitle">Precautions</h4>
    <ul>
     <li>The <strong>new_collation_enabled</strong> configuration item takes effect only when the cluster is initialized. After the cluster is initialized, you cannot enable or disable the new collation framework by modifying the configuration item.</li>
     <li>If the upstream and downstream clusters have different values for <strong>new_collation_enabled</strong> and forcible restoration is performed, Backup &amp; Restore (BR) will report a data verification error.</li>
    </ul>
   </div>
   <div class="section">
    <h4 class="sectiontitle">Symptom</h4>
    <p>An error message indicating <strong>new_collation_enabled</strong> mismatch is displayed during restoration.</p>
   </div>
   <div class="section">
    <h4 class="sectiontitle">Possible Causes</h4>
    <p>In TiDB v6.0.0 and later versions, the default value of <strong>new_collations_enabled_on_first_bootstrap</strong> is changed from <strong>false</strong> to <strong>true</strong>. BR backs up the <strong>new_collation_enabled</strong> configuration item in the <strong>mysql.tidb</strong> table of the upstream cluster. BR securely restores the backup data of the upstream cluster to the downstream cluster only when the upstream and downstream clusters have the same configuration for this configuration item. If the configuration on the upstream cluster is different from that on the downstream cluster, BR will reject the restoration and reports the mismatch error.</p>
   </div>
   <div class="section">
    <h4 class="sectiontitle">Troubleshooting</h4>
    <ol>
     <li><span>Connect to the upstream TiDB database instance using the TiDB client tool.</span></li>
     <li><span>Run the following command to check the <strong>new_collation_enabled</strong> configuration item of the upstream cluster:</span><p></p><pre class="screen">SELECT * FROM mysql.tidb WHERE VARIABLE_NAME = 'new_collation_enabled':</pre> <p>The following is an example of the command output:</p> <p><span><img src="en-us_image_0000002164664442.png"></span></p> <p></p></li>
     <li><span>Connect to the downstream TiDB database instance using the TiDB client tool.</span></li>
     <li><span>Run the following command to check the <strong>new_collation_enabled</strong> configuration item of the downstream cluster:</span><p></p><pre class="screen">SELECT * FROM mysql.tidb WHERE VARIABLE_NAME = 'new_collation_enabled':</pre> <p></p></li>
    </ol>
   </div>
   <p></p>
  </div>
  <div>
   <div class="familylinks">
    <div class="parentlink">
     <strong>Parent topic:</strong> <a href="en-us_topic_0000002164664398.html">FAQs</a>
    </div>
   </div>
  </div>
 </body>
</html>