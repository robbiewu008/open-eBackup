
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Restoring an Oracle Database Instantly">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="en-us_topic_0000001792389316.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="30-OceanProtect Appliance 1.5.0-1.6.0 Help Center">
<meta name="DC.Publisher" content="20240608">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TOPIC_0000001792389268">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>Restoring an Oracle Database Instantly</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="EN-US_TOPIC_0000001792389268"></a><a name="EN-US_TOPIC_0000001792389268"></a>

<h1 class="topictitle1">Restoring an Oracle Database Instantly</h1>
<div><p>This section describes how to instantly restore an Oracle database that has been backed up to the original or new location.</p>
<div class="section"><h4 class="sectiontitle">Context</h4><ul><li>Instant recovery of Oracle databases allows you to specify a copy, a time point, or an SCN.</li><li>An Oracle database can be instantly restored using a backup copy, replication copy, or copy generated by live mount. In addition, an Oracle database can be restored to the original location or a new location. Note that replication copies cannot be used to restore an Oracle database to the original location.<ul><li>Instant recovery to the original location<p>Instant recovery to the original location indicates that data is restored to the original host and directory of the database. During the restoration, the original database is overwritten.</p>
</li><li>Instant recovery to a new location<p>When instant recovery to a new location is performed, the system restores the new database to the specified location. If a database with the same name exists, it will be overwritten.</p>
</li></ul>
</li><li>During instant recovery, if a database with the same name exists in the target location, you are advised not to stop the restoration job. Otherwise, the original database will be damaged.</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Prerequisites</h4><ul><li>ProtectAgent and other related software have been installed on the target host for restoration.<p>For details, see the <i><cite>OceanProtect <span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001792502994_ph19170214112011">Appliance 1.5.0-1.6.0</span> ProtectAgent Installation Guide</cite></i>.</p>
</li><li>When restoring data to the original host and you have configured Oracle Managed Files (OMF) for the host, ensure that the free disk space of the host is greater than the size of the database.</li><li>When restoring data to a different host, ensure that the free disk space of the target host is greater than the size of the database.</li></ul>
</div>
<div class="section"><h4 class="sectiontitle">Procedure</h4><ol><li id="EN-US_TOPIC_0000001792389268__li189532553114"><a name="EN-US_TOPIC_0000001792389268__li189532553114"></a><a name="li189532553114"></a><span>During the restoration, if a database with the same name exists in the target location, shut down the database first. Otherwise, the restoration will fail. To shut down the database, do as follows:</span><p><div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The database with the same name at the target location will be overwritten after the restoration.</p>
</div></div>
<ol type="a" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_ol49608407"><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_li14647185922920">Log in to the Oracle database host.<p id="EN-US_TOPIC_0000001792389268__p8360011829"><a name="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_li14647185922920"></a><a name="en-us_topic_0000001656561309_li14647185922920"></a>Use PuTTY to log in to the Oracle database host and run the <strong id="EN-US_TOPIC_0000001792389268__b154915812148">su - oracle</strong> command to switch to user <strong id="EN-US_TOPIC_0000001792389268__b144975817148">oracle</strong>.</p>
</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_li14572194814339">Run the following commands to log in to the Oracle database instance.<ul id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_ul7420345341"><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_li15682124913711">OS authentication:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p95148598366"><a name="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_li15682124913711"></a><a name="en-us_topic_0000001656561309_en-us_topic_0000001656760969_li15682124913711"></a><strong id="EN-US_TOPIC_0000001792389268__b20891201811475">export ORACLE_SID=</strong><em id="EN-US_TOPIC_0000001792389268__i3891141810471">Database instance name</em></p>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p145141259153613"><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_b1597618293715">sqlplus / as sysdba</strong></p>
</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_li105571236103417">Database authentication:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p920984963717"><a name="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_li105571236103417"></a><a name="en-us_topic_0000001656561309_en-us_topic_0000001656760969_li105571236103417"></a><strong id="EN-US_TOPIC_0000001792389268__b59551219184713">export ORACLE_SID=</strong><em id="EN-US_TOPIC_0000001792389268__i1895571914472">Database instance name</em></p>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p182093496371"><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_b034785743716">sqlplus</strong></p>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p17915722412">Enter the name of a user with the <strong id="EN-US_TOPIC_0000001792389268__b15199825104712">sysdba</strong> permissions as prompted:</p>
<pre class="screen" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_screen9915112104114"><em id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_i1915102164113">username </em>as sysdba</pre>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_en-us_topic_0000001656760969_p159150224117">Enter the password as prompted.</p>
</li></ul>
</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_li198251911109">Run the following command to shut down the database with the same name:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_p96841918142516"><a name="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_li198251911109"></a><a name="en-us_topic_0000001656561309_li198251911109"></a><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656561309_b1025322122520">shutdown immediate;</strong></p>
</li></ol>
</p></li><li id="EN-US_TOPIC_0000001792389268__li17844445165619"><a name="EN-US_TOPIC_0000001792389268__li17844445165619"></a><a name="li17844445165619"></a><span>When restoring data to the original location, ensure that the free memory size of the target host must be greater than the total size of the SGA and PGA of the database. Otherwise, the restoration may fail.</span><p><div class="p">The procedures for checking the memory size, SGA size, and PGA size are as follows:<ol type="a"><li>Check the SGA size and PGA size.<ol class="substepthirdol"><li>Log in to the Oracle database.<p>For details, see <a href="#EN-US_TOPIC_0000001792389268__li189532553114">1</a>.</p>
</li><li>Run the following command to check the SGA size:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p1865918316502"><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b1265903185017">show parameter sga;</strong></p>
<div class="p" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p196591232506">The command output similar to the following is displayed. Check the value of <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol365911365013"><b>sga_target</b></span>.<pre class="screen" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_screen965973135010">SQL&gt; show parameter sga;

NAME                                 TYPE                              VALUE
------------------------------------ --------------------------------- ------------------------------
allow_group_access_to_sga            boolean                            FALSE
lock_sga                             boolean                            FALSE
pre_page_sga                         boolean                            TRUE
sga_max_size                         big integer                        4768M
sga_min_size                         big integer                        0
<strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b365911314501">sga_target                       big integer                    4768M</strong>
unified_audit_sga_queue_size         integer                            1048576</pre>
</div>
</li><li>Run the following command to check the PGA size:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p0659163145014"><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b146599335016">show parameter pga;</strong></p>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p176591235501">The command output similar to the following is displayed. Check the value of <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol66597315507"><b>pga_aggregate_target</b></span>.</p>
<pre class="screen" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_screen865911317505">SQL&gt; show parameter pga;

NAME                                 TYPE                              VALUE
------------------------------------ -------------------------------- ------------------------------
pga_aggregate_limit                  big integer                       3900M
<strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b1865917312504">pga_aggregate_target             big integer                   1589M</strong></pre>
</li><li>Run the following command to check free memory size:<p><strong>free -h</strong></p>
<p>The command output similar to the following is displayed. Check the free memory size. </p>
<pre class="screen">[root@localhost ~]# free -h
              total        used        free      shared  buff/cache   <strong>available</strong>
<strong>Mem</strong>:            15G        2.2G        992M        4.8G         12G        <strong>8.1G</strong>
Swap:           99G          0B         99G</pre>
<p>If the free memory size is not greater than the sum of <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol116596335018"><b>sga_target</b></span> and <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol16607311501"><b>pga_aggregate_target</b></span> values, clear the memory to ensure that the free memory size is greater than the sum of <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol126601137507"><b>sga_target</b></span> and <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol86609310504"><b>pga_aggregate_target</b></span> values.</p>
</li></ol>
</li></ol>
</div>
</p></li><li><span>If the Linux OS is used and the target host for recovery is in the high availability cluster server (HACS) cluster, freeze the HACS cluster before the recovery.</span><p><div class="p" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p73081226165516">You can check whether the target host is in the HACS cluster by referring to <a href="en-us_topic_0000001792389224.html">Checking Whether the Target Recovery Host Is a Host in the HACS Cluster</a>.<ol type="a" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_ol0422132585512"><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li34221251555">Use PuTTY to log in to the Oracle database host as user <strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b248215016391">root</strong>.</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li154221525195516">Run the following command to freeze the HACS cluster:<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p2088691273211"><a name="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li154221525195516"></a><a name="en-us_topic_0000001839188281_li154221525195516"></a><strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b1283231763217">crm configure property maintenance-mode=true</strong></p>
<div class="notice" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_note13422142510556"><span class="noticetitle"><img src="public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p3422122575514">After the restoration job is complete, run the <strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_b144120133406">crm configure property maintenance-mode=false</strong> command to unfreeze the cluster.</p>
</div></div>
</li></ol>
</div>
</p></li><li><span>Choose <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_en-us_topic_0000001839142377_uicontrol1186171611461"><b><span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_en-us_topic_0000001839142377_text6186101615464"><strong>Explore</strong></span> &gt; <span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_en-us_topic_0000001839142377_text74373665812"><strong>Copy Data</strong></span> &gt; <span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_en-us_topic_0000001839142377_text12413710445"><strong>Databases</strong></span> &gt; <span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_en-us_topic_0000001839142377_text151861216124615"><strong>Oracle</strong></span></b></span>.</span></li><li><span>You can search for copies by database resource or copy. This section uses database resources as an example.</span><p><p>On the <span class="wintitle"><b><span><strong>Resources</strong></span></b></span> tab page, locate the database for which instant recovery is to be performed by database name and then click the name.</p>
</p></li><li><span>Specify a copy or time point to perform instant recovery.</span><p><p>You can specify a copy or any time point between two copies for instant recovery.</p>
<div class="p">If you need to specify an SCN for instant recovery, ignore this step and go to <a href="#EN-US_TOPIC_0000001792389268__li02165214225">7</a>.<ol type="a"><li>On the <span><strong>By Date</strong></span> tab page, select a year, month, and day in sequence to search for copies.<p>If <span><img src="en-us_image_0000001839268409.png"></span> is displayed under a month or date, a copy exists in the month or on the date.</p>
</li><li>Perform instant recovery by specifying a copy or any time point between two copies.<ul><li>Specifying a copy for instant recovery<p><span><img class="eddx" src="en-us_image_0000001792389360.png"></span></p>
<p></p>
</li><li>Specifying any time point between two copies<p>On the timeline, <span><img src="en-us_image_0000001886152413.png"></span> indicates that a copy exists at the time point.</p>
<p><span><img class="eddx" src="en-us_image_0000001839188445.png"></span></p>
<p></p>
<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><ul id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_ul75802612312"><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li1497342618234">For 1.5.0, a maximum of 100 copies can be displayed on the timeline. You can click <span><img id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_image173544102299" src="en-us_image_0000001886153709.png"></span> to view all copies.</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li95818264231">During point-in-time recovery, the information about the copy used for restoration cannot be obtained on the management page. Therefore, users cannot view the copy information of the restoration job on pages of the restoration job and related events.</li></ul>
</div></div>
</li></ul>
</li><li id="EN-US_TOPIC_0000001792389268__li10621031104911"><a name="EN-US_TOPIC_0000001792389268__li10621031104911"></a><a name="li10621031104911"></a>Instantly restore the Oracle database to the original location or a new location.<div class="p"><a name="EN-US_TOPIC_0000001792389268__li10621031104911"></a><a name="li10621031104911"></a><ul><li>Instantly restore the Oracle database to the original location.<ol class="substepthirdol"><li>Set <strong>Restore To</strong> to <span class="uicontrol"><b><span><strong>Original location</strong></span></b></span>.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>The remaining space of the disk where the target path is located must be greater than the space occupied by the source database. Otherwise, the restoration job will fail.</p>
</div></div>
</li><li>Set the advanced parameters for instant recovery.<p><a href="#EN-US_TOPIC_0000001792389268__table38941874260">Table 1</a> describes the related parameters.</p>

<div class="tablenoborder"><a name="EN-US_TOPIC_0000001792389268__table38941874260"></a><a name="table38941874260"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TOPIC_0000001792389268__table38941874260" frame="border" border="1" rules="all"><caption><b>Table 1 </b>Advanced parameters of an instant recovery job</caption><colgroup><col style="width:32.800000000000004%"><col style="width:67.2%"></colgroup><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="32.800000000000004%" id="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="67.2%" id="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.2"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="32.800000000000004%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>BCT</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="67.2%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.2 "><ul><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li1406173315719">If you enable the BCT function, the BCT function will be automatically enabled after the restoration is successful.</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li1140663317578">If you disable the BCT function, the BCT function will be automatically disabled after the restoration is successful.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.800000000000004%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>Channels</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="67.2%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.2 "><p>Controls the concurrency of restoration jobs. This parameter specifies the maximum number of connections between RMAN and database instances. If the host performance is average, you are advised to retain the default value. If the host performance is excellent, you can increase the number of channels to improve the concurrency and restoration efficiency. It is recommended that the number of channels be the same as the number of data files.</p>
<p>Value range: <strong>1</strong> to <strong>254</strong>. If this parameter is not specified, value <strong>8</strong> is used by default.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.800000000000004%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>Execution Script</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="67.2%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.2 "><p>You can execute a user-defined script before restoration, upon restoration success, or upon restoration failure as required.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="32.800000000000004%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>Script to Run Before Restoration</strong></span></p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="67.2%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.2 "><p id="EN-US_TOPIC_0000001792389268__p2414113125419">Enter a script name that ends with <strong id="EN-US_TOPIC_0000001792389268__b166310544476">.sh</strong>. Ensure that the script is stored in the <span class="filepath" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001656441509_filepath560914216351"><b>DataBackup/ProtectClient/ProtectClient-E/sbin/thirdparty</b></span> directory in the database host installation directory and the user (user <strong id="EN-US_TOPIC_0000001792389268__b19814202772012">root</strong> by default) who has logged in to the database host is permitted to execute the script. If the user has no execution permission, run the following commands in sequence to grant the permission:</p>
<p><strong>chown root:root</strong> <em>Script name</em></p>
<p><strong>chmod 500</strong><strong> </strong><em>Script name</em></p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p519614617243">When <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol12195646192416"><b><span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_text1119584613243"><strong>Script to Run upon Restoration Success</strong></span></b></span> is configured, the status of the restoration job is displayed as <span class="uicontrol" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_uicontrol4196154615243"><b><span id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_text17195104615249"><strong>Succeeded</strong></span></b></span> on the management page even if the script fails to be executed. Check whether the job details contain a message indicating that a post-processing script fails to be executed. If yes, modify the script in a timely manner. </p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>Script to Run upon Restoration Success</strong></span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.2.6.2.2.2.3.1.1.1.1.2.2.2.3.1.1 "><p><span><strong>Script to Run upon Restoration Failure</strong></span></p>
</td>
</tr>
</tbody>
</table>
</div>
</li><li>Click <span class="uicontrol"><b><span><strong>OK</strong></span></b></span>.</li></ol>
</li><li>Instantly restore the Oracle database to a new location.<ol class="substepthirdol"><li>Set <strong>Restore To</strong> to <span class="uicontrol"><b><span><strong>New location</strong></span></b></span>.</li><li>Set the basic and advanced parameters for instant recovery.<p><a href="#EN-US_TOPIC_0000001792389268__table689710718267">Table 2</a> describes the related parameters.</p>

<div class="tablenoborder"><a name="EN-US_TOPIC_0000001792389268__table689710718267"></a><a name="table689710718267"></a><table cellpadding="4" cellspacing="0" summary="" id="EN-US_TOPIC_0000001792389268__table689710718267" frame="border" border="1" rules="all"><caption><b>Table 2 </b>Instant recovery parameters</caption><colgroup><col style="width:18.41%"><col style="width:81.58999999999999%"></colgroup><thead align="left"><tr><th align="left" class="cellrowborder" valign="top" width="18.41%" id="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1"><p>Parameter</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="81.58999999999999%" id="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Target Host/Cluster</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>Target host or cluster for instant recovery.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p2922101773417">If you want to restore data to a cluster, select a node in the cluster.</p>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><div class="p"><strong>Original Instance</strong><div class="note" id="EN-US_TOPIC_0000001792389268__note15922394357"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__p292039103511">This parameter is available only in 1.6.0 and later versions.</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>Original instance to be restored to the target location.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><div class="p"><strong>Target Instance</strong><div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001792389268_p292039103511">This parameter is available only in 1.6.0 and later versions.</p>
</div></div>
</div>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><div class="p">Name of the instance in the target location for restoration. If you do not set this parameter, the instance name is the same as the original instance name before the restoration.<div class="note" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_note16724735153418"><span class="notetitle"> NOTE: </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p17724173583412">If the target instance name is configured, use the target instance name to log in to the database after the restoration.</p>
</div></div>
</div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Target Path</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>ASM disk group directory or file system directory where the database to be instantly restored is located on the target host. The name of the database remains unchanged after being instantly restored.</p>
<p>An example of the ASM disk group directory is <strong>+ORADATA</strong>, and an example of the file system directory is <strong>/u01/oracle/oradata/</strong>.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><ul><li>If the target path is empty, prepare the ASM disk group directory or file system directory that is the same as that of the production database on the target host in advance.</li><li>The remaining space of the disk where the target path is located must be greater than the space occupied by the source database. Otherwise, the restoration job will fail.</li></ul>
</div></div>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>BCT</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><ul><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li1406173315719_1">If you enable the BCT function, the BCT function will be automatically enabled after the restoration is successful.</li><li id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_li1140663317578_1">If you disable the BCT function, the BCT function will be automatically disabled after the restoration is successful.</li></ul>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Channels</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>Controls the concurrency of restoration jobs. This parameter specifies the maximum number of connections between RMAN and database instances. If the host performance is average, you are advised to retain the default value. If the host performance is excellent, you can increase the number of channels to improve the concurrency and restoration efficiency. It is recommended that the number of channels be the same as the number of data files.</p>
<p>Value range: <strong>1</strong> to <strong>254</strong>. If this parameter is not specified, value <strong>8</strong> is used by default.</p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Script to Run Before Restoration</strong></span></p>
</td>
<td class="cellrowborder" rowspan="3" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>You can execute a user-defined script before instant recovery, upon instant recovery success, or upon instant recovery failure as required.</p>
<p>Enter a script name that ends with <strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001792389268_b166310544476">.sh</strong>. Ensure that the script is stored in the <span class="filepath" id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001792389268_en-us_topic_0000001656441509_filepath560914216351"><b>DataBackup/ProtectClient/ProtectClient-E/sbin/thirdparty</b></span> directory in the database host installation directory and the user (user <strong id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001792389268_b19814202772012">root</strong> by default) who has logged in to the database host is permitted to execute the script. If the user has no execution permission, run the following commands in sequence to grant the permission:</p>
<p><strong>chown root:root</strong> <em>Script name</em></p>
<p><strong>chmod 500</strong><strong> </strong><em>Script name</em></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Script to Run upon Restoration Success</strong></span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Script to Run upon Restoration Failure</strong></span></p>
</td>
</tr>
<tr><td class="cellrowborder" valign="top" width="18.41%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.1 "><p><span><strong>Modify Database Settings</strong></span></p>
</td>
<td class="cellrowborder" valign="top" width="81.58999999999999%" headers="mcps1.3.4.2.6.2.2.2.3.1.1.2.1.2.2.2.3.1.2 "><p>Modify the database parameters based on the actual configuration of the target host. If any parameter is set incorrectly, the database may fail to be restored.</p>
<div class="note"><span class="notetitle"> NOTE: </span><div class="notebody"><p>During restoration, ensure that the free memory size of the target host must be greater than the total size of the SGA and PGA of the database. Otherwise, the restoration may fail.</p>
<ol><li>Check the free memory size of the target host.<p>For details, see <a href="#EN-US_TOPIC_0000001792389268__li17844445165619">2</a>.</p>
</li><li>After enabling <span class="uicontrol"><b><span><strong>Modify Database Settings</strong></span></b></span>, search for <span class="uicontrol"><b>*.pga_aggregate_target</b></span> and <span class="uicontrol"><b>*.sga_target</b></span> parameters.<p>Check whether the free memory size is greater than the sum of <span class="uicontrol"><b>*.pga_aggregate_target</b></span> and <span class="uicontrol"><b>*.sga_target</b></span> values.</p>
<ul><li>If yes, no further action is required.</li><li>If no, go to <a href="#EN-US_TOPIC_0000001792389268__li1089719792612">3</a>.</li></ul>
</li><li id="EN-US_TOPIC_0000001792389268__li1089719792612"><a name="EN-US_TOPIC_0000001792389268__li1089719792612"></a><a name="li1089719792612"></a>Modify either <span class="uicontrol"><b>*.pga_aggregate_target</b></span> or <span class="uicontrol"><b>*.sga_target</b></span> parameters or both of them to ensure that the free memory size is greater than the sum of <span class="uicontrol"><b>*.pga_aggregate_target</b></span> and <span class="uicontrol"><b>*.sga_target</b></span> values.<p>If multiple identical parameters are found, modify all of them.</p>
</li><li>If <span class="uicontrol"><b>*.pga_aggregate_target</b></span> is modified, change <em>Instance name</em><strong>.__pga_aggregate_target</strong> to the following:<p><em>Instance name</em><strong>.__pga_aggregate_target = *.pga_aggregate_target * 1024 *1024</strong></p>
<p>If <span class="uicontrol"><b>*.sga_target</b></span> is modified, change <em>Instance name</em><strong>.__sga_target</strong> to the following:</p>
<p><em>Instance name</em><strong>.__sga_target = *.sga_target</strong><strong> * 1024 *1024</strong></p>
</li></ol>
</div></div>
</td>
</tr>
</tbody>
</table>
</div>
</li><li>Click <span class="uicontrol"><b><span><strong>OK</strong></span></b></span>.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p63168441018">For 1.6.0 and later versions: If the name of the target database for restoration is the same as that of the original database, scan the restoration target resource after the restoration job is complete to ensure that the obtained instance name information is correct.</p>
</div></div>
</li></ol>
</li></ul>
</div>
</li></ol>
</div>
</p></li><li id="EN-US_TOPIC_0000001792389268__li02165214225"><a name="EN-US_TOPIC_0000001792389268__li02165214225"></a><a name="li02165214225"></a><span>Specify an SCN for instant recovery.</span><p><ol type="a"><li>On the <span class="wintitle"><b><span><strong>By SCN</strong></span></b></span> tab page, enter an SCN and choose <span class="uicontrol"><b><span><strong>More</strong></span> &gt; <span><strong>Instant Recovery</strong></span></b></span>.<div class="note"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p>Run the following command to obtain the current SCN of the database:</p>
<p><strong>select dbms_flashback.get_system_change_number from dual;</strong></p>
</div></div>
</li><li>Select a backup copy for restoration.<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p1641915411820">All backup copies that contain the specified SCN are displayed. You can determine the SCN to be restored to based on the time when a backup copy is generated.</p>
<p id="EN-US_TOPIC_0000001792389268__en-us_topic_0000001839188281_p184191549183">If no backup copy is displayed, no logs are backed up at the specified SCN and therefore data cannot be restored based on the SCN. In this case, enter another SCN.</p>
</li><li>Instantly restore the database to its original location or a new location.<p>For details, see <a href="#EN-US_TOPIC_0000001792389268__li10621031104911">6.c</a>.</p>
</li></ol>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="en-us_topic_0000001792389316.html">Instant Recovery</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div></body>
</html>