<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="DC.Type" content="topic">
  <meta name="DC.Title" content="Performing Periodic Backup">
  <meta name="product" content="">
  <meta name="DC.Relation" scheme="URI" content="en-us_topic_0000001839268309.html">
  <meta name="prodname" content="">
  <meta name="version" content="">
  <meta name="brand" content="30-OceanProtect Appliance 1.5.0-1.6.0 Help Center">
  <meta name="DC.Publisher" content="20240608">
  <meta name="DC.Format" content="XHTML">
  <meta name="DC.Identifier" content="EN-US_TOPIC_0000001792389308">
  <meta name="DC.Language" content="en-us">
  <link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
  <title>Performing Periodic Backup</title>
 </head>
 <body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px">
  <a name="EN-US_TOPIC_0000001792389308"></a><a name="EN-US_TOPIC_0000001792389308"></a>
  <h1 class="topictitle1">Performing Periodic Backup</h1>
  <div>
   <p>After resources to be protected are associated with an SLA, the system protects the resources based on the SLA.</p>
   <div class="section">
    <h4 class="sectiontitle">Precautions</h4>
    <p id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_p5298101017162"><span id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_ph259092114816">If a full backup fails and the next backup is the log backup, the log backup job will fail because log backup depends on the copy generated in the last successful full backup. In this case, you need to manually perform a full backup.</span></p>
   </div>
   <div class="section" id="EN-US_TOPIC_0000001792389308__section68231216228">
    <h4 class="sectiontitle">Prerequisites</h4>
    <ul id="EN-US_TOPIC_0000001792389308__ul512180103212">
     <li id="EN-US_TOPIC_0000001792389308__li712119013220">You are advised to disable KRB trace of the database. Otherwise, a large number of KRB trace files will be generated during the backup, occupying the storage space of the host. For details about how to disable KRB trace, see <a href="en-us_topic_0000001839268305.html">How Do I Disable the KRB Trace of an Oracle Database?</a>.</li>
     <li id="EN-US_TOPIC_0000001792389308__li168585418321">For 1.6.0 and later versions: If you need to perform snapshot-based backup at the storage layer in ASM scenarios, contact technical support engineers to configure Udev in the production environment. For details, see <a href="en-us_topic_0000001864661961.html">Configuring Udev (Applicable to Snapshot-based Backup at the Storage Layer)</a>.</li>
     <li id="EN-US_TOPIC_0000001792389308__li584882135013">For 1.6.0 and later versions: If you need to perform snapshot-based backup at the storage layer in non-ASM scenarios, ensure that the directories where the data, control, and log files, as well as pfile and spfile parameter files of the Oracle database reside have been mounted to OceanStor Dorado.</li>
    </ul>
   </div>
   <div class="section">
    <h4 class="sectiontitle">Procedure</h4>
    <ol>
     <li><span>Choose <span class="uicontrol" id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001839142377_uicontrol49641842919"><b><span id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001839142377_text63901566195"><strong>Protection</strong></span> &gt; Databases &gt; Oracle</b></span>.</span></li>
    </ol>
    <ol start="2">
     <li><span>On the <span class="uicontrol" id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_uicontrol13647121671614"><b><span id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_text4647616121615"><strong>Databases</strong></span></b></span> tab page, select the database that you want to protect and click <span class="uicontrol" id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_uicontrol851716476568"><b><span id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_text5546154284118"><strong>Protect</strong></span></b></span>. </span><p></p><p id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_p1478765116562">You can also select multiple databases for batch protection.</p> <p></p></li>
     <li><span>Select an SLA. </span><p></p><p id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_p33248794210">You can also click <span class="uicontrol" id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_uicontrol197631711131711"><b><span id="EN-US_TOPIC_0000001792389308__en-us_topic_0000001792503842_text16757131110174"><strong>Create</strong></span></b></span> to create an SLA.</p> <p></p></li>
     <li id="EN-US_TOPIC_0000001792389308__li164660725814"><a name="EN-US_TOPIC_0000001792389308__li164660725814"></a><a name="li164660725814"></a><span>Set the advanced parameters for backing up the Oracle database.</span><p></p>
      <div class="p">
       <a href="#EN-US_TOPIC_0000001792389308__table354613271506">Table 1</a> describes the related parameters. 
       <div class="tablenoborder">
        <a name="EN-US_TOPIC_0000001792389308__table354613271506"></a><a name="table354613271506"></a>
        <table cellpadding="4" cellspacing="0" summary="" id="EN-US_TOPIC_0000001792389308__table354613271506" frame="border" border="1" rules="all">
         <caption>
          <b>Table 1 </b>Advanced parameters for backing up the Oracle database
         </caption>
         <colgroup>
          <col style="width:22.11%">
          <col style="width:77.89%">
         </colgroup>
         <thead align="left">
          <tr>
           <th align="left" class="cellrowborder" valign="top" width="22.11%" id="mcps1.3.4.3.3.2.1.2.2.3.1.1"><p>Parameter</p></th>
           <th align="left" class="cellrowborder" valign="top" width="77.89%" id="mcps1.3.4.3.3.2.1.2.2.3.1.2"><p>Description</p></th>
          </tr>
         </thead>
         <tbody>
          <tr>
           <td class="cellrowborder" valign="top" width="22.11%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><span><strong>Delete Archived Logs Immediately After Backup</strong></span></p></td>
           <td class="cellrowborder" valign="top" width="77.89%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.2 "><p>Indicates whether to delete archive logs in the production environment after log backup is complete.</p></td>
          </tr>
          <tr>
           <td class="cellrowborder" valign="top" width="22.11%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><strong>Snapshot-based Backup at the Storage Layer</strong></p></td>
           <td class="cellrowborder" valign="top" width="77.89%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.2 "><p>After this function is enabled, data is backed up in storage-layer backup mode. After snapshot-based backup at the storage layer is enabled, you can select a built-in or external agent host to back up the database using snapshots at the storage layer.</p>
            <div class="note">
             <span class="notetitle"> NOTE: </span>
             <div class="notebody">
              <ul>
               <li>Only 1.6.0 and later versions support this function.</li>
               <li>In the Oracle single-node scenario, if the selected SLA contains the differential backup policy, snapshot-based backup at the storage layer cannot be enabled.</li>
               <li>In the Oracle cluster scenario, if the selected SLA contains the differential backup policy or replication policy, snapshot-based backup at the storage layer cannot be enabled.</li>
               <li>Ensure that the ASM disk group where the database resources to be protected reside does not have other database instances. Otherwise, snapshot-based backup at the storage layer is not supported.</li>
               <li>If the Windows OS is used, select a built-in agent host or an external Linux agent host where the Oracle plug-in is installed after snapshot-based backup at the storage layer is enabled.</li>
               <li>If Oracle version 11 is used, the system automatically enables the storage-layer backup mode of the Oracle database during snapshot creation.</li>
              </ul>
             </div>
            </div></td>
          </tr>
          <tr>
           <td class="cellrowborder" valign="top" width="22.11%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><span><strong>Agent Host</strong></span></p></td>
           <td class="cellrowborder" valign="top" width="77.89%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.2 "><p>Agent host used for backup. You can select multiple agent hosts. If this parameter is not set, the system selects one agent host by default.</p>
            <div class="note">
             <span class="notetitle"> NOTE: </span>
             <div class="notebody">
              <ul>
               <li>If you manually select an agent host, the database authentication mode must be <strong>Database authentication</strong>. Otherwise, backup and recovery jobs will fail.</li>
               <li>If this parameter is automatically specified by the system and the database authentication mode is set to <strong>Database authentication</strong> or <strong>OS authentication</strong>, backup and recovery jobs are not affected.</li>
              </ul>
             </div>
            </div></td>
          </tr>
          <tr>
           <td class="cellrowborder" valign="top" width="22.11%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><span><strong>Script to Run Before Backup</strong></span></p></td>
           <td class="cellrowborder" rowspan="3" valign="top" width="77.89%" headers="mcps1.3.4.3.3.2.1.2.2.3.1.2 "><p>You can configure <span><strong>Script to Run Before Backup</strong></span>, <span><strong>Script to Run upon Backup Success</strong></span>, and <span><strong>Script to Run upon Backup Failure</strong></span> based on the site requirements. When the message "ProtectAgent started executing the prerequisite task." is displayed in the backup job event, the configured script will be executed in the corresponding scenario.</p>
            <ul id="EN-US_TOPIC_0000001792389308__ul15603161520372">
             <li id="EN-US_TOPIC_0000001792389308__li1460341514374">If the Linux OS is used, enter the script name, which ends with <strong id="EN-US_TOPIC_0000001792389308__b9862201614336">.sh</strong>. Ensure that the script is stored in the <span class="filepath" id="EN-US_TOPIC_0000001792389308__filepath560914216351"><b>DataBackup/ProtectClient/ProtectClient-E/sbin/thirdparty</b></span> directory in the database host installation directory and the user (user <strong id="EN-US_TOPIC_0000001792389308__b85901723113320">root</strong> by default) who has logged in to the database host is permitted to execute the script. If the user has no execution permission, run the following commands in sequence to grant the permission:<p id="EN-US_TOPIC_0000001792389308__p16108247123612"><strong id="EN-US_TOPIC_0000001792389308__b81136193713">chown root:root</strong> <em id="EN-US_TOPIC_0000001792389308__i16108134713615">Script name</em></p> <p id="EN-US_TOPIC_0000001792389308__p161081847163612"><strong id="EN-US_TOPIC_0000001792389308__b911119173711">chmod 500</strong><strong id="EN-US_TOPIC_0000001792389308__b87241853163611"> </strong><em id="EN-US_TOPIC_0000001792389308__i107241353203616">Script name</em></p></li>
             <li id="EN-US_TOPIC_0000001792389308__li9864508377">If the Windows OS is used, enter the script name, which ends with <strong id="EN-US_TOPIC_0000001792389308__b5380181217343">.bat</strong>. Ensure that the script is stored in the <span class="filepath" id="EN-US_TOPIC_0000001792389308__filepath178625093713"><b>DataBackup\ProtectClient\ProtectClient-E\bin\thirdparty</b></span> directory in the database host installation directory and the user (<strong id="EN-US_TOPIC_0000001792389308__b758118331474">Administrator</strong> by default) who has logged in to the database host is permitted to execute the script. If the user has no execution permission, perform the following operations in sequence to grant the permission:<p id="EN-US_TOPIC_0000001792389308__p13417214119">Right-click the script and choose <strong id="EN-US_TOPIC_0000001792389308__b127151555124618">Properties</strong> &gt; <strong id="EN-US_TOPIC_0000001792389308__b06501857114610">Security</strong>. In the dialog box that is displayed, select the <strong id="EN-US_TOPIC_0000001792389308__b2683192618473">Administrator</strong> user and click <strong id="EN-US_TOPIC_0000001792389308__b1388103134712">Edit</strong> to change the permission.</p></li>
            </ul>
            <div class="note">
             <span class="notetitle"> NOTE: </span>
             <div class="notebody">
              <ul>
               <li>If <span class="uicontrol"><b><span><strong>Script to Run upon Backup Success</strong></span></b></span> is configured, the status of the backup job is displayed as <span class="uicontrol"><b><span><strong>Succeeded</strong></span></b></span> on the management page even if the script fails to be executed. Check whether the job details contain a message indicating that a post-processing script fails to be executed. If yes, modify the script in a timely manner.</li>
               <li>When backing up the database of the Oracle cluster environment, pay attention to the following if the pre-processing or post-processing script is configured:
                <ul>
                 <li>The pre-processing or post-processing script must be stored on all nodes in the cluster.</li>
                 <li>By default, the <span>product</span> executes this script only on one node in the cluster. If the script needs to be executed on all nodes in the cluster, add the content for logging in to each node in the cluster when compiling the script.</li>
                </ul></li>
              </ul>
             </div>
            </div></td>
          </tr>
          <tr>
           <td class="cellrowborder" valign="top" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><span><strong>Script to Run upon Backup Success</strong></span></p></td>
          </tr>
          <tr>
           <td class="cellrowborder" valign="top" headers="mcps1.3.4.3.3.2.1.2.2.3.1.1 "><p><span><strong>Script to Run upon Backup Failure</strong></span></p></td>
          </tr>
         </tbody>
        </table>
       </div>
      </div> <p></p></li>
     <li><span>Click <span class="uicontrol"><b>OK</b></span>.</span><p></p><p>If the current system time is later than the first backup start time of the SLA, you can perform manual backup immediately after the backup SLA is associated or wait for the next scheduling based on the backup policy set in the SLA.</p>
      <div class="note">
       <img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span>
       <div class="notebody">
        <ul>
         <li>During the backup job execution, you are advised not to restart the ProtectAgent host or ProtectAgent service. Otherwise, the backup job may be suspended. If the backup job is suspended for a long time after the restart, terminate the job and perform the backup again.</li>
         <li><span id="EN-US_TOPIC_0000001792389308__ph1559428114314">When the <span id="EN-US_TOPIC_0000001792389308__text22246311345">product</span> detects data file changes during log backup, the log backup job automatically changes to a full backup. During the time when a log backup job is automatically changing to a full backup (you can choose <strong id="EN-US_TOPIC_0000001792389308__b57514217582">Insight</strong> &gt; <strong id="EN-US_TOPIC_0000001792389308__b07511421585">Jobs</strong> and select the corresponding backup job to view the job details), the other backup jobs delivered will fail to be locked. As a result, the other backup jobs fail to be executed.</span></li>
        </ul>
       </div>
      </div> <p></p></li>
    </ol>
   </div>
  </div>
  <div>
   <div class="familylinks">
    <div class="parentlink">
     <strong>Parent topic:</strong> <a href="en-us_topic_0000001839268309.html">Step 9: Performing Backup</a>
    </div>
   </div>
  </div>
 </body>
</html>