swagger: '2.0'
info:
  version: v1
  title: 统一调度接口
  contact: {}
  license: {}
host: localhost
basePath: /
tags:
  - name: Scheduler API
    description: Scheduler Controller
paths:
  /v1/schedules:
    post:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      x-product: CyberEngine,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      tags:
        - Scheduler API
      summary: createSchedule
      operationId: createScheduleUsingPOST
      consumes:
        - application/json
      produces:
        - '*/*'
      parameters:
        - in: body
          name: schedule
          description: schedule
          required: true
          schema:
            $ref: '#/definitions/Schedule'
            originalRef: Schedule
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/ScheduleResponse'
            originalRef: ScheduleResponse
        '201':
          description: Created
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
      deprecated: false
      x-order: 0
    delete:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      x-product: CyberEngine,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      tags:
        - Scheduler API
      summary: batchDeleteSchedule
      operationId: batchDeleteScheduleUsingDELETE
      produces:
        - '*/*'
      parameters:
        - in: body
          name: deleteReq
          description: deleteReq
          required: true
          schema:
            $ref: '#/definitions/BatchOperationRequest'
            originalRef: BatchOperationRequest
      responses:
        '200':
          description: OK
        '204':
          description: No Content
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
      security:
        - Authorization:
            - global
      deprecated: false
      x-order: 1
  /v1/schedules/next-time/{schedule_id}:
    get:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      x-product: CyberEngine,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      tags:
        - Scheduler API
      summary: getNextTime
      operationId: getNextTimeUsingGET
      produces:
        - '*/*'
      parameters:
        - name: schedule_id
          in: path
          description: schedule_id
          required: true
          type: string
      responses:
        '200':
          description: OK
          schema:
            type: string
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
        '404':
          description: Not Found
      security:
        - Authorization:
            - global
      deprecated: false
      x-order: 2
  /v1/schedules/{schedule_id}:
    delete:
      x-dr-role: 'N'
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 25081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      x-product: CyberEngine,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      tags:
        - Scheduler API
      summary: deleteSchedule
      operationId: deleteScheduleUsingDELETE
      produces:
        - '*/*'
      parameters:
        - name: schedule_id
          in: path
          description: schedule_id
          required: true
          type: string
      responses:
        '200':
          description: OK
        '204':
          description: No Content
        '401':
          description: Unauthorized
        '403':
          description: Forbidden
      security:
        - Authorization:
            - global
      deprecated: false
      x-order: 4
  /v1/internal/schedules/crons/{cron}/next-time:
    get:
      x-dr-role: 'N'
      x-product: CyberEngine,OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 30081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      x-request-examples-url-1: https://127.0.0.1:25080/v1/internal/schedules/crons/{cron}/next-time?cron=XXX&fromDate=XXX&times=XXX
      tags:
        - Scheduler API
      summary: 获取首次备份时间
      description: 获取首次备份时间
      operationId: getCronNextTimeUsingGet
      parameters:
        - name: cron
          in: path
          required: true
          type: string
        - name: fromDate
          in: query
          required: false
          description: 指定的开始时间点
          type: string
        - name: times
          in: query
          required: false
          description: 指定的下次执行次数
          type: string
      responses:
        '200':
          description: OK
          schema:
            type: string
        '400':
          description: Bad Request
          schema:
            type: string
        '404':
          description: Not Found
          schema:
            type: string
        '500':
          description: Internal Server Error
          schema:
            type: string
        '502':
          description: Bad Gateway
          schema:
            type: string
      x-order: 3
  /v1/internal/health:
    get:
      x-dr-role: 'N'
      x-product: OceanProtect X8000,OceanProtect X6000,OceanProtect X3000
      x-dm-role: 'N'
      x-impact-subsystem: 不影响
      x-access-port: 30081
      x-auth-required: 'N'
      x-rd-admin-role: 'N'
      x-auditor-role: 'N'
      x-dp-admin-role: 'N'
      x-public-api: 'N'
      x-sysadmin-role: 'N'
      tags:
        - Scheduler API
      summary: 检查健康状态
      description: 检查健康状态
      operationId: scheduleInternalHealthUsingGET
      responses:
        '200':
          description: OK
          schema:
            type: string
      x-order: 5
securityDefinitions:
  Authorization:
    type: apiKey
    name: TOKEN
    in: header
definitions:
  BatchOperationRequest:
    type: object
    properties:
      scheduleIds:
        type: array
        items:
          type: string
    title: BatchOperationRequest
  Schedule:
    type: object
    properties:
      action:
        type: string
      context:
        type: boolean
      daily_end_time:
        type: string
      daily_start_time:
        type: string
      day_of_month:
        type: string
      day_of_week:
        type: string
      day_of_year:
        type: string
      end_date:
        type: string
      interval:
        type: string
      params:
        type: object
      replace_existing:
        type: boolean
      schedule_name:
        type: string
      schedule_type:
        type: string
      start_date:
        type: string
      task:
        type: object
    title: Schedule
  ScheduleResponse:
    type: object
    properties:
      schedule_id:
        type: string
    title: ScheduleResponse
