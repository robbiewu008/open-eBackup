swagger: '2.0'
info:
  title: 资源管理（kubernetes）
  version: v1
paths:
  '/v1/internal/kubernetes/{cluster_id}':
    get:
      produces:
        - application/json
      parameters:
        - description: Kubernetes集群UUID
          in: path
          name: cluster_id
          required: true
          type: string
      responses:
        '200':
          description: Successful Response
          schema:
            $ref: '#/definitions/KubernetesClusterAuthInfo'
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: >-
        internal_get_cluster_auth_info_by_id_v1_internal_kubernetes__cluster_id__get
      summary: 查询指定Kubernetes集群的认证信息【内部接口】
  /v1/kubernetes:
    get:
      produces:
        - application/json
      parameters:
        - description: Kubernetes集群名称条件参数
          in: query
          maxLength: 64
          minLength: 1
          name: name
          required: false
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            items:
              $ref: '#/definitions/KubernetesClusterResp'
            title: Response List Clusters V1 Kubernetes Get
            type: array
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: list_clusters_v1_kubernetes_get
      summary: 查询Kubernetes集群列表
    post:
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
        - in: body
          name: body
          required: true
          schema:
            allOf:
              - $ref: '#/definitions/KubernetesClusterReq'
            description: 注册Kubernetes集群请求参数
            title: Cluster Req
      responses:
        '200':
          description: Successful Response
          schema: {}
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: register_kubernetes_v1_kubernetes_post
      summary: 注册Kubernetes集群
  '/v1/kubernetes/namespaces/{namespace_id}':
    get:
      produces:
        - application/json
      parameters:
        - description: Namespace的UUID
          in: path
          name: namespace_id
          required: true
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            $ref: '#/definitions/KubernetesNamespaceDetailResp'
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: >-
        get_kubernetes_namespace_by_id_v1_kubernetes_namespaces__namespace_id__get
      summary: 查询指定Namespace的信息
  '/v1/kubernetes/namespaces/{namespace_id}/configurations':
    get:
      produces:
        - application/json
      parameters:
        - description: Namespace的UUID
          in: path
          name: namespace_id
          required: true
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            items:
              $ref: '#/definitions/KubernetesCommonObjResp'
            title: >-
              Response List Configs Of Namespace V1 Kubernetes Namespaces 
              Namespace Id  Configurations Get
            type: array
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: >-
        list_configs_of_namespace_v1_kubernetes_namespaces__namespace_id__configurations_get
      summary: 查询指定Namespace的Configuration列表
  '/v1/kubernetes/namespaces/{namespace_id}/networkings':
    get:
      produces:
        - application/json
      parameters:
        - description: Namespace的UUID
          in: path
          name: namespace_id
          required: true
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            items:
              $ref: '#/definitions/KubernetesCommonObjResp'
            title: >-
              Response List Networking Of Namespace V1 Kubernetes Namespaces 
              Namespace Id  Networkings Get
            type: array
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: >-
        list_networking_of_namespace_v1_kubernetes_namespaces__namespace_id__networkings_get
      summary: 查询指定Namespace的Networking列表
  '/v1/kubernetes/namespaces/{namespace_id}/storages':
    get:
      produces:
        - application/json
      parameters:
        - description: Namespace的UUID
          in: path
          name: namespace_id
          required: true
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            items:
              $ref: '#/definitions/KubernetesStorageResp'
            title: >-
              Response List Storages Of Namespace V1 Kubernetes Namespaces 
              Namespace Id  Storages Get
            type: array
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: >-
        list_storages_of_namespace_v1_kubernetes_namespaces__namespace_id__storages_get
      summary: 查询指定Namespace的Storage列表
  '/v1/kubernetes/{cluster_id}':
    get:
      produces:
        - application/json
      parameters:
        - description: Kubernetes集群UUID
          in: path
          name: cluster_id
          required: true
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            $ref: '#/definitions/KubernetesClusterDetailResp'
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: get_cluster_by_id_v1_kubernetes__cluster_id__get
      summary: 查询指定Kubernetes集群的信息
  '/v1/kubernetes/{cluster_id}/namespaces':
    get:
      produces:
        - application/json
      parameters:
        - description: Kubernetes集群UUID
          in: path
          name: cluster_id
          required: true
          type: string
        - description: 分页页面编码
          in: query
          maximum: 10000
          minimum: 0
          name: page_no
          required: true
          type: integer
        - description: 分页数据条数
          in: query
          maximum: 200
          minimum: 0
          name: page_size
          required: true
          type: integer
        - description: Namespace名称条件参数
          in: query
          name: name
          required: false
          type: string
        - description: 访问令牌
          in: header
          name: X-Auth-Token
          required: true
      responses:
        '200':
          description: Successful Response
          schema:
            $ref: '#/definitions/BasePage_KubernetesNamespaceResp_'
        '404':
          description: Not found
        '422':
          description: Validation Error
          schema:
            $ref: '#/definitions/HTTPValidationError'
      tags:
        - kubernetes
      operationId: page_query_namespaces_v1_kubernetes__cluster_id__namespaces_get
      summary: 分页查询指定Kubernetes集群的Namespace列表
  /v1/readiness:
    get:
      produces:
        - application/json
      parameters: []
      responses:
        '200':
          description: Successful Response
          schema: {}
      operationId: readiness_v1_readiness_get
      summary: Readiness
definitions:
  BasePage_KubernetesNamespaceResp_:
    properties:
      items:
        description: 数据列表
        items:
          $ref: '#/definitions/KubernetesNamespaceResp'
        title: Items
        type: array
      page_no:
        description: 页面编号
        title: Page No
        type: integer
      page_size:
        description: 每页数据量
        title: Page Size
        type: integer
      pages:
        description: 总页数
        title: Pages
        type: integer
      total:
        description: 总的数据条数
        title: Total
        type: integer
    required:
      - total
      - pages
      - page_size
      - page_no
      - items
    title: 'BasePage[KubernetesNamespaceResp]'
    type: object
  HTTPValidationError:
    properties:
      detail:
        items:
          $ref: '#/definitions/ValidationError'
        title: Detail
        type: array
    title: HTTPValidationError
    type: object
  K8sAuthTypeEnum:
    description: K8S认证类别
    enum:
      - 1
      - 2
    title: K8sAuthTypeEnum
    type: integer
  K8sBackupProxy:
    properties:
      concurrent_num:
        description: 任务并行数量
        title: Concurrent Num
        type: integer
      node_selector:
        description: Node选择器名称
        title: Node Selector
        type: string
      proxy_img_tag:
        description: 备份代理镜像的tag名称
        title: Proxy Img Tag
        type: string
    title: K8sBackupProxy
    type: object
  KubernetesClusterAuthInfo:
    properties:
      host:
        description: Kubernetes集群IP地址或者域名
        title: Host
        type: string
      auth_info:
        description: Kubernetes集群认证Token或者kubeconfig信息
        title: Auth Info
        type: string
      auth_type:
        $ref: '#/definitions/K8sAuthTypeEnum'
      port:
        default: 6443
        description: Kubernetes集群端口号
        title: Port
        type: integer
      uuid:
        description: Kubernetes集群UUID
        title: Uuid
        type: string
    required:
      - uuid
      - auth_type
      - auth_info
      - host
    title: KubernetesClusterAuthInfo
    type: object
  KubernetesClusterDetailResp:
    properties:
      host:
        description: Kubernetes集群IP地址或者域名
        title: Host
        type: string
      backup_proxy:
        allOf:
          - $ref: '#/definitions/K8sBackupProxy'
        description: Kubernetes备份代理信息
        title: Backup Proxy
      link_status:
        description: Kubernetes连接状态，0-在线，1-离线
        title: Link Status
        type: integer
      name:
        description: Kubernetes集群名称
        title: Name
        type: string
      port:
        default: 6443
        description: Kubernetes集群端口号
        title: Port
        type: integer
      uuid:
        description: Kubernetes集群UUID
        title: Uuid
        type: string
      version:
        description: Kubernetes版本号
        title: Version
        type: string
    title: KubernetesClusterDetailResp
    type: object
  KubernetesClusterReq:
    properties:
      host:
        description: Kubernetes集群IP地址或者域名（Token认证必传）
        title: Host
        type: string
      auth_type:
        $ref: '#/definitions/K8sAuthTypeEnum'
      kube_config:
        description: Kubernetes集群kubeconfig内容（kubeconfig认证必传）
        title: Kube Config
        type: string
      name:
        description: Kubernetes集群名称，长度范围是1到64位，只能以字母、中文或_开头，由数字、字母、中文、_和-组成。
        maxLength: 64
        minLength: 1
        pattern: '^[a-zA-Z_\u4e00-\u9fa5]{1}[\u4e00-\u9fa5\w-]*$'
        title: Name
        type: string
      port:
        default: 6443
        description: Kubernetes集群端口号（Token认证必传）
        title: Port
        type: integer
      token:
        description: Kubernetes集群Token（Token认证必传）
        title: Token
        type: string
    required:
      - name
      - auth_type
    title: KubernetesClusterReq
    type: object
  KubernetesClusterResp:
    properties:
      name:
        description: Kubernetes集群名称
        title: Name
        type: string
      uuid:
        description: Kubernetes集群UUID
        title: Uuid
        type: string
    title: KubernetesClusterResp
    type: object
  KubernetesCommonObjResp:
    properties:
      name:
        description: Kubernetes对象名称
        title: Name
        type: string
      type:
        description: Kubernetes对象类型
        title: Type
        type: string
    title: KubernetesCommonObjResp
    type: object
  KubernetesNamespaceDetailResp:
    properties:
      config_num:
        default: 0
        description: Configuration数量
        title: Config Num
        type: integer
      link_status:
        description: Namespace连接状态，0-在线，1-离线
        title: Link Status
        type: integer
      name:
        description: Namespace名称
        title: Name
        type: string
      networking_num:
        default: 0
        description: Networking数量
        title: Networking Num
        type: integer
      storage_capacity:
        default: 0
        description: Storage容量，单位：Gi
        title: Storage Capacity
        type: number
      uuid:
        description: Namespace的UUID
        title: Uuid
        type: string
      workload_num:
        default: 0
        description: Workload数量
        title: Workload Num
        type: integer
    title: KubernetesNamespaceDetailResp
    type: object
  KubernetesNamespaceResp:
    properties:
      name:
        description: Namespace名称
        title: Name
        type: string
      uuid:
        description: Namespace的UUID
        title: Uuid
        type: string
    title: KubernetesNamespaceResp
    type: object
  KubernetesStorageResp:
    properties:
      name:
        description: Kubernetes对象名称
        title: Name
        type: string
      size:
        description: Storage容量，单位：Gi
        title: Size
        type: number
      type:
        description: Kubernetes对象类型
        title: Type
        type: string
    title: KubernetesStorageResp
    type: object
  ValidationError:
    properties:
      loc:
        items:
          type: string
        title: Location
        type: array
      msg:
        title: Message
        type: string
      type:
        title: Error Type
        type: string
    required:
      - loc
      - msg
      - type
    title: ValidationError
    type: object
x-components: {}

